<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bambú CRM - Ventas V2</title>
    <link rel="stylesheet" href="shared/tokens.css">
    <link rel="stylesheet" href="shared/components.css">
    <link rel="stylesheet" href="assets/ventas/ventas-specific.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <div class="app-wrapper">
        <!-- SIDEBAR -->
        <nav class="sidebar" id="main-sidebar">
            <div class="sidebar-header">
                <div class="logo-icon">
                    <i class="fas fa-leaf"></i>
                </div>
                <span class="logo-text">Bambú CRM</span>
            </div>

            <button class="toggle-sidebar-float" id="btn-toggle-sidebar" title="Expandir/Colapsar">
                <i class="fas fa-chevron-left"></i>
            </button>

            <div class="nav-content">
                <div class="nav-highlight">
                    <button class="btn-cotizador-nav" onclick="location.href='cotizador.html'">
                        <i class="fas fa-calculator"></i>
                        <span>COTIZADOR</span>
                    </button>
                </div>

                <ul class="nav-menu">
                    <li title="Dashboard" onclick="location.href='dashboard.html'">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </li>
                    <li title="Clientes" onclick="location.href='clientes.html'">
                        <i class="fas fa-users"></i>
                        <span>Clientes</span>
                    </li>
                    <li title="Productos y Stock" onclick="location.href='productos.html'">
                        <i class="fas fa-box"></i>
                        <span>Productos y Stock</span>
                    </li>
                    <li title="Ventas" class="active" onclick="location.href='ventas.html'">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Ventas <small class="badge-new">NUEVO</small></span>
                    </li>
                    <li title="Repartos">
                        <i class="fas fa-truck"></i>
                        <span>Repartos</span>
                    </li>
                    <li title="Reportes y Estadísticas">
                        <i class="fas fa-chart-line"></i>
                        <span>Reportes</span>
                    </li>
                    <li title="Respaldos">
                        <i class="fas fa-server"></i>
                        <span>Respaldos</span>
                    </li>
                </ul>

                <div class="nav-footer">
                    <li title="Configuración">
                        <i class="fas fa-cog"></i>
                        <span>Configuración</span>
                    </li>
                    <li title="Cambiar tema" onclick="toggleTheme()">
                        <i class="fas fa-moon" id="theme-icon"></i>
                        <span>Tema</span>
                    </li>
                </div>
            </div>
        </nav>

        <!-- MAIN LAYOUT -->
        <main class="main-layout">

            <!-- HEADER (con filtros integrados) -->
            <header class="header-toolbar-ventas">
                <div class="page-header-title">
                    <i class="fas fa-money-bill-wave" style="color: var(--text-secondary);"></i>
                    Ventas
                </div>

                <!-- Filtros compactos (sin labels) -->
                <div class="filters-inline">
                    <select class="select-filter-compact" id="filter-estado">
                        <option value="todos">Estado: Todos</option>
                        <option value="transito">Estado: En Tránsito</option>
                        <option value="entregado">Estado: Entregado</option>
                    </select>

                    <div class="filter-periodo-compact">
                        <input type="date" class="input-date-compact" id="filter-fecha-desde" value="2025-12-01">
                        <span class="periodo-arrow">→</span>
                        <input type="date" class="input-date-compact" id="filter-fecha-hasta" value="2025-12-31">
                    </div>

                    <select class="select-filter-compact" id="filter-tipo">
                        <option value="todos">Tipo: Todos</option>
                        <option value="fabrica">Tipo: Fábrica</option>
                        <option value="reparto">Tipo: Reparto</option>
                    </select>

                    <select class="select-filter-compact" id="filter-vehiculo">
                        <option value="todos">Vehículo: Todos</option>
                        <option value="sin-asignar">Vehículo: Sin asignar</option>
                        <option value="r1">Vehículo: Reparto 1</option>
                        <option value="r2">Vehículo: Reparto 2</option>
                        <option value="r3">Vehículo: Reparto 3</option>
                    </select>

                    <select class="select-filter-compact" id="filter-pago">
                        <option value="todos">Pago: Todos</option>
                        <option value="efectivo">Pago: Efectivo</option>
                        <option value="digital">Pago: Digital</option>
                        <option value="mixto">Pago: Mixto</option>
                        <option value="sin-registrar">Pago: Sin registrar</option>
                    </select>

                    <button class="btn-ghost-sm" onclick="limpiarFiltros()" title="Limpiar filtros">
                        <i class="fas fa-redo"></i>
                    </button>

                    <button class="btn-excel"><i class="fas fa-file-excel"></i> Exportar Excel</button>
                </div>
            </header>

            <!-- VIEW SWITCHER (reordenado) -->
            <div class="view-switcher-bar">
                <div class="view-tabs">
                    <button class="view-tab active" onclick="switchView('calendario')" data-view="calendario">
                        <i class="fas fa-calendar-week"></i> Calendario Semana
                    </button>
                    <button class="view-tab" onclick="switchView('pedidos')" data-view="pedidos">
                        <i class="fas fa-list"></i> Lista Pedidos
                    </button>
                    <button class="view-tab" onclick="switchView('borradores')" data-view="borradores">
                        <i class="fas fa-file-alt"></i> Borradores
                    </button>
                </div>
                <div class="results-count-container">
                    <span class="results-count">60 resultados</span>
                    <span id="badge-estado-dia-lista"></span>
                </div>
            </div>

            <!-- STATS PANEL COMPACTO (una línea inline) -->
            <div class="stats-panel-compact">
                <div class="stat-inline">
                    <i class="fas fa-box"></i>
                    <span class="stat-value">60</span>
                    <span class="stat-label">PEDIDOS</span>
                </div>

                <div class="stat-divider-vertical"></div>

                <div class="stat-inline">
                    <i class="fas fa-dollar-sign"></i>
                    <span class="stat-value">$5,800,000</span>
                    <span class="stat-label">MONTO TOTAL</span>
                </div>

                <div class="stat-divider-vertical"></div>

                <div class="stat-inline">
                    <i class="fas fa-weight"></i>
                    <span class="stat-value">1,810 kg</span>
                    <span class="stat-label">PESO TOTAL</span>
                </div>

                <div class="stat-divider-vertical"></div>

                <div class="stat-inline">
                    <i class="fas fa-industry"></i>
                    <span class="stat-label">Fábrica:</span>
                    <span class="stat-value">9 pedidos</span>
                    <span class="stat-meta">($850k)</span>
                </div>

                <div class="stat-inline">
                    <i class="fas fa-truck"></i>
                    <span class="stat-label">Reparto:</span>
                    <span class="stat-value">51 pedidos</span>
                    <span class="stat-meta">($4,950k)</span>
                </div>
            </div>

            <!-- VISTA PEDIDOS -->
            <div class="view-container hidden" id="view-pedidos">
                <div class="list-container">
                    <!-- Barra de acciones bulk -->
                    <div class="barra-bulk-actions hidden" id="barra-bulk-actions">
                        <div class="bulk-info">
                            <i class="fas fa-check-square"></i>
                            <span id="bulk-count">0 pedidos seleccionados</span>
                        </div>
                        <div class="bulk-actions-buttons">
                            <button class="btn-bulk-primary" onclick="marcarSeleccionadosComoEntregado()">
                                <i class="fas fa-check-circle"></i>
                                Marcar como Entregado
                            </button>
                            <button class="btn-bulk-secondary" onclick="cancelarSeleccion()">
                                <i class="fas fa-times"></i>
                                Cancelar
                            </button>
                        </div>
                    </div>

                    <table class="table-ventas">
                        <thead>
                            <tr>
                                <th style="width: 40px;"><input type="checkbox" /></th>
                                <th style="width: 90px;"># Pedido</th>
                                <th style="width: 85px;">Fecha</th>
                                <th style="width: 240px;">Cliente / Dirección</th>
                                <th style="width: 100px;">Teléfono</th>
                                <th style="width: 100px;">Tipo</th>
                                <th style="width: 130px;">Estado</th>
                                <th style="width: 85px;">Reparto</th>
                                <th style="width: 110px; text-align: right;">Total</th>
                                <th style="width: 60px;">Pago</th>
                                <th style="width: 160px;">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Pedido 1: EN TRÁNSITO (sin pago registrado) -->
                            <!-- Los pedidos se renderizan dinámicamente con JS -->
                        </tbody>
                        <tfoot>
                            <tr style="background: #f8f9fa; font-weight: 600; border-top: 2px solid #dee2e6;">
                                <td colspan="8" style="text-align: right; padding-right: 1rem;">TOTAL:</td>
                                <td style="text-align: right; color: #28a745;" id="suma-total-pedidos">$0</td>
                                <td colspan="2"></td>
                            </tr>
                        </tfoot>
                    </table>

                    <!-- Paginación -->
                    <div class="pagination">
                        <button class="btn-page"><i class="fas fa-chevron-left"></i></button>
                        <button class="btn-page active">1</button>
                        <button class="btn-page">2</button>
                        <button class="btn-page">3</button>
                        <button class="btn-page">4</button>
                        <button class="btn-page">5</button>
                        <button class="btn-page"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- VISTA BORRADORES (hidden by default) -->
            <div class="view-container hidden" id="view-borradores">
                <div class="list-container">
                    <table class="table-ventas">
                        <thead>
                            <tr>
                                <th style="width: 40px;"><input type="checkbox" /></th>
                                <th style="width: 100px;"># Borrador</th>
                                <th style="width: 110px;">Fecha</th>
                                <th style="width: 300px;">Cliente / Dirección</th>
                                <th style="width: 100px;">Tipo</th>
                                <th style="width: 150px;">Items / Peso</th>
                                <th style="width: 110px; text-align: right;">Total</th>
                                <th style="width: 200px;">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tbody-borradores">
                            <!-- Se renderiza dinámicamente con JS -->
                        </tbody>
                    </table>

                    <!-- Paginación borradores -->
                    <div class="pagination" id="pagination-borradores"></div>
                </div>
            </div>

            <!-- VISTA CALENDARIO SEMANA (visible por defecto) -->
            <div class="view-container" id="view-calendario">
                <div class="calendario-container">
                    <!-- Header calendario -->
                    <div class="calendario-header">
                        <h3>Semana: 23 - 27 Diciembre 2025</h3>
                        <div class="calendario-nav">
                            <button class="btn-nav"><i class="fas fa-chevron-left"></i> Anterior</button>
                            <button class="btn-nav-today">Hoy</button>
                            <button class="btn-nav">Siguiente <i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>

                    <!-- Grid calendario semanal -->
                    <div class="calendario-grid">
                        <!-- Fábrica -->
                        <div class="dia-card fabrica-card">
                            <div class="dia-header">
                                <span class="dia-label">FÁBRICA</span>
                                <span class="dia-numero"><i class="fas fa-industry"></i></span>
                                <span class="dia-tipo">Vendidos en fábrica</span>
                                <span class="badge-estado-semanal">Semanal</span>
                            </div>
                            <div class="dia-stats">
                                <div class="dia-stat">
                                    <i class="fas fa-box"></i>
                                    <span><strong>9 pedidos</strong></span>
                                </div>
                                <div class="dia-stat">
                                    <i class="fas fa-weight"></i>
                                    <span><strong>270 kg</strong></span>
                                </div>
                            </div>
                            <!-- Línea efectivo/digital (fábrica = XXX) -->
                            <div class="dia-pagos-line">
                                <span class="pago-item">
                                    <i class="fas fa-money-bill-wave"></i> XXX
                                </span>
                                <span class="pago-item">
                                    <i class="fas fa-credit-card"></i> XXX
                                </span>
                            </div>
                            <div class="dia-botones">
                                <button class="btn-filtrar-lista-dia" onclick="verVentasFabrica()">
                                    <i class="fas fa-list"></i> Ver pedidos
                                </button>
                            </div>
                        </div>

                        <!-- Lunes 23 - PASADO CONTROLADO -->
                        <div class="dia-card dia-controlado" data-dia="lunes" data-fecha="2025-12-23" onclick="seleccionarDia(this, 'lunes')">
                            <div class="dia-header">
                                <span class="dia-label">LUNES</span>
                                <span class="dia-numero">23</span>
                                <span class="dia-tipo">Reparto</span>
                                <span class="badge-estado-controlado">Controlado</span>
                            </div>
                            <div class="dia-stats">
                                <div class="dia-stat">
                                    <i class="fas fa-box"></i>
                                    <span><strong>10/40 ped</strong></span>
                                </div>
                                <div class="dia-stat">
                                    <i class="fas fa-weight"></i>
                                    <span><strong>285/6250 kg</strong></span>
                                </div>
                            </div>
                            <!-- Línea efectivo/digital (controlado = números reales) -->
                            <div class="dia-pagos-line">
                                <span class="pago-item">
                                    <i class="fas fa-money-bill-wave"></i> <strong>$180k</strong>
                                </span>
                                <span class="pago-item">
                                    <i class="fas fa-credit-card"></i> <strong>$105k</strong>
                                </span>
                            </div>
                            <div class="dia-botones">
                                <button class="btn-ver-detalle-dia" onclick="verDetalleDia(event, '2025-12-23')">
                                    <i class="fas fa-eye"></i> Ver detalle
                                </button>
                                <button class="btn-filtrar-lista-dia" onclick="filtrarListaPorDia(event, '2025-12-23')">
                                    <i class="fas fa-list"></i> Ver pedidos
                                </button>
                            </div>
                        </div>

                        <!-- Martes 24 - PASADO SIN CONTROL -->
                        <div class="dia-card dia-sin-control" data-dia="martes" data-fecha="2025-12-24" onclick="seleccionarDia(this, 'martes')">
                            <div class="dia-header">
                                <span class="dia-label">MARTES</span>
                                <span class="dia-numero">24</span>
                                <span class="dia-tipo">Reparto</span>
                                <button class="badge-estado-controlar"
                                        onclick="filtrarListaPorDia(event, '2025-12-24'); event.stopPropagation();"
                                        title="Ver pedidos del día para controlar">
                                    Controlar
                                </button>
                            </div>
                            <div class="dia-stats">
                                <div class="dia-stat">
                                    <i class="fas fa-box"></i>
                                    <span><strong>10/40 ped</strong></span>
                                </div>
                                <div class="dia-stat">
                                    <i class="fas fa-weight"></i>
                                    <span><strong>310/6250 kg</strong></span>
                                </div>
                            </div>
                            <!-- Línea efectivo/digital (sin control = XXX) -->
                            <div class="dia-pagos-line">
                                <span class="pago-item">
                                    <i class="fas fa-money-bill-wave"></i> XXX
                                </span>
                                <span class="pago-item">
                                    <i class="fas fa-credit-card"></i> XXX
                                </span>
                            </div>
                            <div class="dia-botones">
                                <button class="btn-ver-detalle-dia" onclick="verDetalleDia(event, '2025-12-24')">
                                    <i class="fas fa-eye"></i> Ver detalle
                                </button>
                                <button class="btn-filtrar-lista-dia" onclick="filtrarListaPorDia(event, '2025-12-24')">
                                    <i class="fas fa-list"></i> Ver pedidos
                                </button>
                            </div>
                        </div>

                        <!-- Miércoles 25 - DÍA HOY (actual) -->
                        <div class="dia-card active dia-hoy" data-dia="miercoles" data-fecha="2025-12-25" onclick="seleccionarDia(this, 'miercoles')">
                            <div class="dia-header">
                                <span class="dia-label">MIÉRCOLES</span>
                                <span class="dia-numero">25</span>
                                <span class="dia-tipo">Reparto</span>
                                <span class="dia-badge-hoy" title="Día actual">
                                    <i class="fas fa-circle"></i> HOY
                                </span>
                            </div>
                            <div class="dia-stats">
                                <div class="dia-stat">
                                    <i class="fas fa-box"></i>
                                    <span><strong>12/40 ped</strong></span>
                                </div>
                                <div class="dia-stat">
                                    <i class="fas fa-weight"></i>
                                    <span><strong>380/6250 kg</strong></span>
                                </div>
                            </div>
                            <!-- Línea efectivo/digital (hoy = XXX) -->
                            <div class="dia-pagos-line">
                                <span class="pago-item">
                                    <i class="fas fa-money-bill-wave"></i> XXX
                                </span>
                                <span class="pago-item">
                                    <i class="fas fa-credit-card"></i> XXX
                                </span>
                            </div>
                            <div class="dia-botones">
                                <button class="btn-ver-detalle-dia" onclick="verDetalleDia(event, '2025-12-25')">
                                    <i class="fas fa-eye"></i> Ver detalle
                                </button>
                                <button class="btn-filtrar-lista-dia" onclick="filtrarListaPorDia(event, '2025-12-25')">
                                    <i class="fas fa-list"></i> Ver pedidos
                                </button>
                            </div>
                        </div>

                        <!-- Jueves 26 - DÍA FUTURO -->
                        <div class="dia-card" data-dia="jueves" data-fecha="2025-12-26" onclick="seleccionarDia(this, 'jueves')">
                            <div class="dia-header">
                                <span class="dia-label">JUEVES</span>
                                <span class="dia-numero">26</span>
                                <span class="dia-tipo">Reparto</span>
                                <span class="badge-estado-planificado">Planificado</span>
                            </div>
                            <div class="dia-stats">
                                <div class="dia-stat">
                                    <i class="fas fa-box"></i>
                                    <span><strong>10/40 ped</strong></span>
                                </div>
                                <div class="dia-stat">
                                    <i class="fas fa-weight"></i>
                                    <span><strong>295/6250 kg</strong></span>
                                </div>
                            </div>
                            <!-- Línea efectivo/digital (futuro = XXX) -->
                            <div class="dia-pagos-line">
                                <span class="pago-item">
                                    <i class="fas fa-money-bill-wave"></i> XXX
                                </span>
                                <span class="pago-item">
                                    <i class="fas fa-credit-card"></i> XXX
                                </span>
                            </div>
                            <div class="dia-botones">
                                <button class="btn-ver-detalle-dia" onclick="verDetalleDia(event, '2025-12-26')">
                                    <i class="fas fa-eye"></i> Ver detalle
                                </button>
                                <button class="btn-filtrar-lista-dia" onclick="filtrarListaPorDia(event, '2025-12-26')">
                                    <i class="fas fa-list"></i> Ver pedidos
                                </button>
                            </div>
                        </div>

                        <!-- Viernes 27 - DÍA FUTURO -->
                        <div class="dia-card" data-dia="viernes" data-fecha="2025-12-27" onclick="seleccionarDia(this, 'viernes')">
                            <div class="dia-header">
                                <span class="dia-label">VIERNES</span>
                                <span class="dia-numero">27</span>
                                <span class="dia-tipo">Reparto</span>
                                <span class="badge-estado-planificado">Planificado</span>
                            </div>
                            <div class="dia-stats">
                                <div class="dia-stat">
                                    <i class="fas fa-box"></i>
                                    <span><strong>9/40 ped</strong></span>
                                </div>
                                <div class="dia-stat">
                                    <i class="fas fa-weight"></i>
                                    <span><strong>270/6250 kg</strong></span>
                                </div>
                            </div>
                            <!-- Línea efectivo/digital (futuro = XXX) -->
                            <div class="dia-pagos-line">
                                <span class="pago-item">
                                    <i class="fas fa-money-bill-wave"></i> XXX
                                </span>
                                <span class="pago-item">
                                    <i class="fas fa-credit-card"></i> XXX
                                </span>
                            </div>
                            <div class="dia-botones">
                                <button class="btn-ver-detalle-dia" onclick="verDetalleDia(event, '2025-12-27')">
                                    <i class="fas fa-eye"></i> Ver detalle
                                </button>
                                <button class="btn-filtrar-lista-dia" onclick="filtrarListaPorDia(event, '2025-12-27')">
                                    <i class="fas fa-list"></i> Ver pedidos
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Capacidades de vehículos (se actualiza según día seleccionado) -->
                    <div class="vehiculos-capacidades" id="vehiculos-capacidades">
                        <!-- Se renderiza dinámicamente con JS -->
                    </div>

                    <div class="calendario-hint">
                        <i class="fas fa-info-circle"></i>
                        Click en un día para ver capacidades de vehículos. Click en "Ver detalle" para ver lista completa de pedidos con opción de editar, marcar como entregado, etc.
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- MODAL: Editar Pedido -->
    <div class="modal-overlay hidden" id="modal-editar-pedido">
        <div class="modal-content modal-edit-large">
            <div class="modal-header">
                <div class="modal-header-info">
                    <h3><i class="fas fa-edit"></i> Editar Pedido <span id="edit-pedido-num">#00467</span></h3>
                    <div class="pedido-cliente-info">
                        <i class="fas fa-user"></i>
                        <span id="edit-cliente-nombre">ARAUCACÍAS 371</span>
                        <span class="separator">•</span>
                        <span id="edit-cliente-dir">3 items · 12kg</span>
                    </div>
                </div>
                <button class="btn-close-modal" onclick="cerrarModalEditar()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body-edit-grid">
                <!-- Área de productos (70%) -->
                <div class="edit-productos-area">
                    <table class="table-edit-productos">
                        <thead>
                            <tr>
                                <th style="width: 40%;">Producto</th>
                                <th style="width: 12%; text-align: center;">Peso</th>
                                <th style="width: 16%; text-align: right;">P. Unit.</th>
                                <th style="width: 12%; text-align: center;">Cant.</th>
                                <th style="width: 16%; text-align: right;">Subtotal</th>
                                <th style="width: 4%; text-align: center;"></th>
                            </tr>
                        </thead>
                        <tbody id="edit-productos-tbody">
                            <!-- Se renderiza con JS -->
                        </tbody>
                    </table>

                    <button class="btn-agregar-producto" onclick="abrirModalAgregarProducto()">
                        <i class="fas fa-plus-circle"></i> Agregar producto
                    </button>
                </div>

                <!-- Panel lateral totales (30%) -->
                <div class="edit-panel-totales">
                    <div class="totales-edit-section">
                        <div class="total-row">
                            <span class="label">Subtotal:</span>
                            <span class="value" id="edit-subtotal">$0</span>
                        </div>
                        <div class="total-row">
                            <span class="label">Desc. Nivel:</span>
                            <span class="value" id="edit-descuentos">-$0</span>
                        </div>
                        <div class="total-row">
                            <span class="label">Desc. Manual:</span>
                            <span class="value" id="edit-desc-manual">-$0</span>
                        </div>
                        <div class="total-row">
                            <span class="label">Ajustes:</span>
                            <span class="value" id="edit-ajustes">-$0</span>
                        </div>

                        <div class="total-divider"></div>

                        <div class="total-row total-nuevo">
                            <span class="label">TOTAL NUEVO:</span>
                            <span class="value" id="edit-total-nuevo">$0</span>
                        </div>

                        <div class="total-divider"></div>

                        <div class="total-row text-muted-row">
                            <span class="label">Total anterior:</span>
                            <span class="value" id="edit-total-anterior">$0</span>
                        </div>

                        <div class="total-row diferencia-row">
                            <span class="label">Diferencia:</span>
                            <span class="value" id="edit-diferencia">$0</span>
                        </div>

                        <div class="peso-info">
                            <i class="fas fa-weight"></i>
                            <span>Peso total: <strong id="edit-peso-total">0kg</strong></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn-secondary" onclick="cerrarModalEditar()">Cancelar</button>
                <button class="btn-primary" onclick="guardarEdicion()">
                    <i class="fas fa-save"></i> Guardar Cambios
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL: Marcar como Entregado -->
    <div class="modal-overlay hidden" id="modal-entregado">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle"></i> Marcar Pedido como ENTREGADO</h3>
                <button class="btn-close-modal" onclick="cerrarModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body">
                <div class="pedido-info">
                    <div class="info-row">
                        <span class="label">Pedido:</span>
                        <span class="value" id="modal-pedido-num">#00467</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Cliente:</span>
                        <span class="value" id="modal-cliente-nombre">ARAUCACÍAS 371</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Total pedido:</span>
                        <span class="value"><strong id="modal-pedido-total">$45.800</strong></span>
                    </div>
                </div>

                <div class="divider-modal"></div>

                <div class="info-pago-cc">
                    <div class="icon-info-wrapper">
                        <i class="fas fa-money-check-alt"></i>
                    </div>
                    <div class="info-content">
                        <h4>Registro de pagos</h4>
                        <p>Los pagos se registran desde <strong>Cuenta Corriente</strong> del cliente.</p>
                        <p class="text-muted-small">Puedes marcar el pedido como entregado ahora y registrar el pago
                            después desde el perfil del cliente.</p>

                        <button class="btn-ir-cc" onclick="irACuentaCorriente()">
                            <i class="fas fa-arrow-right"></i> Ir a Cuenta Corriente
                        </button>
                    </div>
                </div>

                <div class="divider-modal"></div>

                <div class="editar-hint">
                    <i class="fas fa-info-circle"></i>
                    ¿Hubo cambios en cantidades o productos?
                    <button class="btn-link" onclick="abrirModalEditar()">
                        <i class="fas fa-edit"></i> Editar pedido antes de marcar entregado
                    </button>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn-secondary" onclick="cerrarModal()">Cancelar</button>
                <button class="btn-primary" onclick="confirmarEntregado()">
                    <i class="fas fa-check"></i> Marcar como Entregado
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL: Ver Detalle Pedido -->
    <div class="modal-overlay hidden" id="modal-ver-detalle">
        <div class="modal-content modal-detalle-large">
            <div class="modal-header">
                <div class="modal-header-info">
                    <h3><i class="fas fa-file-invoice"></i> Detalle del Pedido <span
                            id="detalle-pedido-num">#00467</span></h3>
                    <div class="pedido-estado-info">
                        <span class="badge-estado" id="detalle-estado-badge">EN TRÁNSITO</span>
                        <span class="separator">•</span>
                        <span id="detalle-fecha">Lunes 23 Dic 2025</span>
                    </div>
                </div>
                <button class="btn-close-modal" onclick="cerrarModalDetalle()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body-detalle-grid">
                <!-- Área principal (70%) -->
                <div class="detalle-main-area">
                    <!-- Info Cliente -->
                    <div class="detalle-section">
                        <div class="section-title">
                            <i class="fas fa-user"></i> Cliente
                        </div>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Nombre:</span>
                                <span class="info-value" id="detalle-cliente-nombre">ARAUCACÍAS 371</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Teléfono:</span>
                                <span class="info-value" id="detalle-cliente-tel">294-123456</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Dirección:</span>
                                <span class="info-value" id="detalle-cliente-dir">Araucacías 371, Bariloche</span>
                            </div>
                        </div>
                    </div>

                    <!-- Productos -->
                    <div class="detalle-section">
                        <div class="section-title">
                            <i class="fas fa-box"></i> Productos
                        </div>
                        <table class="table-detalle-productos">
                            <thead>
                                <tr>
                                    <th style="width: 50%;">Producto</th>
                                    <th style="width: 10%; text-align: center;">Peso</th>
                                    <th style="width: 15%; text-align: right;">P. Unit.</th>
                                    <th style="width: 10%; text-align: center;">Cant.</th>
                                    <th style="width: 15%; text-align: right;">Subtotal</th>
                                </tr>
                            </thead>
                            <tbody id="detalle-productos-tbody">
                                <!-- Se renderiza con JS -->
                            </tbody>
                        </table>

                        <div class="peso-total-row">
                            <i class="fas fa-weight"></i>
                            <span>Peso total: <strong id="detalle-peso-total">0kg</strong></span>
                        </div>
                    </div>

                    <!-- Notas (si existe) -->
                    <div class="detalle-section" id="detalle-notas-section" style="display: none;">
                        <div class="section-title">
                            <i class="fas fa-sticky-note"></i> Notas
                        </div>
                        <div class="nota-content" id="detalle-nota-texto">
                            <!-- Se renderiza con JS -->
                        </div>
                    </div>
                </div>

                <!-- Panel lateral info financiera (30%) -->
                <div class="detalle-sidebar">
                    <!-- Totales -->
                    <div class="detalle-sidebar-section">
                        <div class="sidebar-section-title">Resumen Financiero</div>

                        <div class="total-row">
                            <span class="label">Subtotal:</span>
                            <span class="value" id="detalle-subtotal">$0</span>
                        </div>
                        <div class="total-row">
                            <span class="label">Desc. Nivel:</span>
                            <span class="value" id="detalle-descuentos">-$0</span>
                        </div>
                        <div class="total-row">
                            <span class="label">Desc. Manual:</span>
                            <span class="value" id="detalle-desc-manual">-$0</span>
                        </div>
                        <div class="total-row">
                            <span class="label">Ajustes:</span>
                            <span class="value" id="detalle-ajustes">-$0</span>
                        </div>

                        <div class="total-row total-destacado">
                            <span class="label">TOTAL PEDIDO:</span>
                            <span class="value" id="detalle-total">$0</span>
                        </div>
                    </div>

                    <!-- Método de Pago -->
                    <div class="detalle-sidebar-section">
                        <div class="sidebar-section-title">Método de Pago</div>
                        <div class="metodo-pago-display" id="detalle-metodo-pago">
                            <!-- Se renderiza con JS -->
                        </div>
                    </div>

                    <!-- Estado Pago -->
                    <div class="detalle-sidebar-section">
                        <div class="sidebar-section-title">Estado de Pago</div>
                        <div class="estado-pago-info">
                            <div class="total-row">
                                <span class="label">Monto pagado:</span>
                                <span class="value" id="detalle-pagado">$0</span>
                            </div>
                            <div class="total-row">
                                <span class="label">Pendiente:</span>
                                <span class="value pendiente-valor" id="detalle-pendiente">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Entrega (si está entregado) -->
                    <div class="detalle-sidebar-section" id="detalle-entrega-section" style="display: none;">
                        <div class="sidebar-section-title">Información de Entrega</div>
                        <div class="entrega-info">
                            <div class="info-item-small">
                                <i class="fas fa-calendar-check"></i>
                                <span id="detalle-fecha-entrega">25/12/2025 14:30</span>
                            </div>
                            <div class="info-item-small">
                                <i class="fas fa-user"></i>
                                <span id="detalle-usuario-entrega">Juan Pérez</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn-secondary" onclick="cerrarModalDetalle()">Cerrar</button>
                <button class="btn-primary" onclick="abrirEditarDesdeDetalle()">
                    <i class="fas fa-edit"></i> Editar Pedido
                </button>
            </div>
        </div>
    </div>

    <script src="shared/utils.js"></script>
    <script src="assets/ventas/script.js"></script>

</body>

</html>