<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bambu CRM v2 - Flujo Ventas Nuevo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/styles.css">
</head>

<body>

    <button class="mobile-menu-toggle" onclick="document.getElementById('sidebar').classList.toggle('open')">â˜°
        MenÃº</button>

    <nav id="sidebar">
        <div class="logo">
            <span>â—†</span> Bambu CRM v2
        </div>

        <div class="nav-group">
            <div class="nav-header">DocumentaciÃ³n</div>
            <a href="index.html" class="nav-link">â† Volver al PRD</a>
        </div>

        <div class="nav-group">
            <div class="nav-header">Ãndice</div>
            <a href="#contexto" class="nav-link">1. Contexto y Problema</a>
            <a href="#sistema-actual" class="nav-link">2. Sistema Actual (v1)</a>
            <a href="#feedback-cliente" class="nav-link">3. Feedback Cliente</a>
            <a href="#propuesta-nueva" class="nav-link">4. Propuesta Nueva</a>
            <a href="#flujos-detallados" class="nav-link">5. Flujos Detallados</a>
            <a href="#especificacion-ventas" class="nav-link">6. EspecificaciÃ³n Ventas</a>
            <a href="#impacto-prd" class="nav-link">7. Impacto en PRD</a>
        </div>

        <div class="nav-group">
            <div class="nav-header">Temas Clave</div>
            <a href="#interaccion-modulos" class="nav-link">â†’ InteracciÃ³n MÃ³dulos</a>
            <a href="#cuenta-corriente" class="nav-link">â†’ Cuenta Corriente</a>
            <a href="#historial-cambios" class="nav-link">â†’ AuditorÃ­a</a>
        </div>

        <div class="nav-group">
            <div class="nav-header">Prototipo HTML</div>
            <a href="#prototipo-ui" class="nav-link">7. ImplementaciÃ³n</a>
            <a href="#prototipo-ui" class="nav-link">7.11 Estados de dÃ­as</a>
        </div>
    </nav>

    <main>
        <header>
            <div
                style="margin-bottom: 1rem; font-size: 0.9rem; color: var(--text-secondary); text-transform: uppercase;">
                QuÃ­mica Bambu S.R.L.</div>
            <h1>Bambu CRM v2 <br><span style="font-weight: 300; font-size: 1.5rem; color: var(--text-secondary);">Flujo
                    Ventas Nuevo - AnÃ¡lisis Completo</span></h1>

            <table>
                <tr>
                    <td style="width: 150px;"><strong>Fecha</strong></td>
                    <td>22 de Diciembre 2025</td>
                </tr>
                <tr>
                    <td><strong>Sistema</strong></td>
                    <td>Bambu CRM v2</td>
                </tr>
                <tr>
                    <td><strong>PropÃ³sito</strong></td>
                    <td>RediseÃ±ar mÃ³dulo Ventas fusionando Pedidos + HistÃ³rico</td>
                </tr>
            </table>
        </header>

        <section id="contexto">
            <h2>1. Contexto y Problema</h2>

            <h3>SituaciÃ³n actual</h3>
            <p>El PRD tiene 3 mÃ³dulos separados para gestiÃ³n de pedidos:</p>
            <ul>
                <li><strong>3.2 Cotizador</strong>: Crear pedidos</li>
                <li><strong>3.3 Pedidos</strong>: Listar y gestionar pedidos</li>
                <li><strong>3.8 Ventas</strong> (ex-HistÃ³rico): Ver pedidos entregados</li>
            </ul>

            <h3>Problema identificado</h3>
            <p>SegÃºn feedback cliente (Carlos), el mÃ³dulo Ventas debe cumplir una funciÃ³n diferente:</p>
            <blockquote>
                "Es donde se terminan de confeccionar el detalle de cÃ³mo se entregaron los pedidos. Lo que realmente se
                vendiÃ³. Porque en reparto es lo que vamos a llevar. Pero despuÃ©s en ventas es lo que efectivamente se
                vendiÃ³ y cÃ³mo se vendiÃ³."
            </blockquote>

            <p><strong>FunciÃ³n real</strong>: MÃ³dulo donde se "pulen" los pedidos post-entrega:</p>
            <ul>
                <li>Corregir cantidades entregadas vs planificadas</li>
                <li>Ajustar descuentos olvidados</li>
                <li>Sumar/restar productos por cambios de Ãºltimo momento</li>
                <li><strong>Registrar mÃ©todos de pago reales</strong> (efectivo, digital)</li>
                <li>Hacer ajustes finales</li>
            </ul>
        </section>

        <section id="sistema-actual">
            <h2>2. Sistema Actual (v1)</h2>

            <h3>MÃ³dulo Pedidos (v1)</h3>
            <p><strong>UbicaciÃ³n</strong>: Dashboard â†’ Pedidos</p>

            <p><strong>FunciÃ³n</strong>:</p>
            <ul>
                <li>Lista TODOS los pedidos con estado "confirmado"</li>
                <li>Desde aquÃ­ se cambia estado manualmente para asignar fecha</li>
                <li>Permite editar pedidos</li>
            </ul>

            <p><strong>Estados en v1</strong>:</p>
            <ol>
                <li>Borrador</li>
                <li><strong>Confirmado</strong> â† Aparecen aquÃ­</li>
                <li>Para despacho</li>
                <li>En trÃ¡nsito</li>
                <li>Entregado</li>
                <li>Cancelado</li>
            </ol>

            <p><strong>Flujo v1</strong>:</p>
            <pre><code>CotizaciÃ³n â†’ Confirma â†’ Estado "Confirmado"
                              â†“
                      MÃ³dulo PEDIDOS
                              â†“
                  Cambiar estado manualmente
                              â†“
                      "Para despacho"
                              â†“
                  AsignaciÃ³n de vehÃ­culos
                              â†“
                      "En trÃ¡nsito"
                              â†“
                      "Entregado"</code></pre>

            <h3>MÃ³dulo HistÃ³rico (v1)</h3>
            <p><strong>UbicaciÃ³n</strong>: Dashboard â†’ Repartos â†’ HistÃ³rico</p>

            <p><strong>FunciÃ³n</strong>:</p>
            <ul>
                <li>Muestra SOLO pedidos con estado "entregado"</li>
                <li>Filtros: Fecha, VehÃ­culo, Tipo (fÃ¡brica/reparto)</li>
                <li>Solo lectura (no editable)</li>
            </ul>

            <p><strong>Filtros actuales</strong>:</p>
            <ul>
                <li>PerÃ­odo (desde-hasta)</li>
                <li>VehÃ­culo especÃ­fico</li>
                <li>Tipo: FÃ¡brica | Reparto</li>
            </ul>
        </section>

        <section id="feedback-cliente">
            <h2>3. Feedback Cliente</h2>

            <h3>Necesidades identificadas:</h3>
            <ol>
                <li>âœ… <strong>Corregir cantidades</strong>: Planificado 10, entregado 9</li>
                <li>âœ… <strong>Ajustar descuentos</strong>: Olvidamos aplicar descuento</li>
                <li>âœ… <strong>Sumar/restar productos</strong>: Cambios de Ãºltimo momento</li>
                <li>âœ… <strong>Ajustar mÃ©todos de pago</strong>: Efectivo vs Digital (MercadoPago)</li>
                <li>âœ… <strong>Editar pedidos post-entrega</strong>: Poder modificar despuÃ©s de marcar como entregado
                </li>
                <li>âœ… <strong>Vista unificada</strong>: Ver tanto "en trÃ¡nsito" como "entregados"</li>
            </ol>
        </section>

        <section id="propuesta-nueva">
            <h2>4. Propuesta Nueva Arquitectura</h2>

            <h3>DecisiÃ³n: Fusionar Pedidos + HistÃ³rico â†’ VENTAS</h3>

            <p><strong>Eliminamos</strong>:</p>
            <ul>
                <li>âŒ MÃ³dulo 3.3 Pedidos (como mÃ³dulo separado)</li>
                <li>âŒ MÃ³dulo "Pendientes de asignaciÃ³n"</li>
                <li>âŒ Concepto "HistÃ³rico"</li>
                <li>âŒ Estados intermedios: "Confirmado" y "Listo para despacho"</li>
            </ul>

            <p><strong>Creamos</strong>:</p>
            <ul>
                <li>âœ… <strong>MÃ³dulo VENTAS</strong> unificado (todos los pedidos post-cotizaciÃ³n)</li>
                <li>âœ… <strong>Calendario integrado en cotizador</strong> (asignaciÃ³n directa de fecha)</li>
            </ul>

            <h3>Comparativa v1 vs v2:</h3>
            <table>
                <tr>
                    <th>Aspecto</th>
                    <th>v1 (Actual)</th>
                    <th>v2 (Propuesto)</th>
                </tr>
                <tr>
                    <td><strong>Estados</strong></td>
                    <td>6 estados: Borrador, Confirmado, Listo despacho, En trÃ¡nsito, Entregado, Cancelado</td>
                    <td>3 estados: Borrador, En trÃ¡nsito, Entregado</td>
                </tr>
                <tr>
                    <td><strong>AsignaciÃ³n fecha</strong></td>
                    <td>Manual en mÃ³dulo "Pendientes asignaciÃ³n"</td>
                    <td>AutomÃ¡tica en cotizador (calendario integrado)</td>
                </tr>
                <tr>
                    <td><strong>MÃ³dulo Pedidos</strong></td>
                    <td>Separado (solo confirmados)</td>
                    <td>âŒ Eliminado â†’ Integrado en VENTAS</td>
                </tr>
                <tr>
                    <td><strong>MÃ³dulo HistÃ³rico</strong></td>
                    <td>Separado (solo lectura)</td>
                    <td>âŒ Eliminado â†’ Integrado en VENTAS (editable)</td>
                </tr>
                <tr>
                    <td><strong>Pendientes asignaciÃ³n</strong></td>
                    <td>MÃ³dulo separado para asignar dÃ­a</td>
                    <td>âŒ Eliminado (se asigna desde cotizador)</td>
                </tr>
                <tr>
                    <td><strong>EdiciÃ³n post-entrega</strong></td>
                    <td>âŒ No permitido</td>
                    <td>âœ… Permitido en VENTAS con auditorÃ­a</td>
                </tr>
                <tr>
                    <td><strong>MÃ©todo de pago</strong></td>
                    <td>âŒ No registrado</td>
                    <td>âœ… Campo obligatorio (efectivo/digital/mixto)</td>
                </tr>
                <tr>
                    <td><strong>Clicks para pedido reparto</strong></td>
                    <td>7 pasos manuales</td>
                    <td>4 pasos simplificados</td>
                </tr>
            </table>

            <h3>Nuevo flujo v2:</h3>

            <h4>MODO REPARTO (Flujo completo detallado):</h4>
            <pre><code>1. COTIZADOR:
   Usuario selecciona modo REPARTO
   Se abre calendario integrado en cotizador
   Selecciona fecha de entrega (lunes-viernes)
   Confirma pedido
       â†“
2. SISTEMA:
   Estado cambia a "En trÃ¡nsito" DIRECTO
   (sin pasar por Confirmado ni Listo despacho)
   Stock se descuenta
   Cargo en cuenta corriente se genera
   Pedido queda asignado al dÃ­a seleccionado
       â†“
3. MÃ“DULO VENTAS:
   Pedido aparece con filtro "En trÃ¡nsito"
   Estado: SIN vehÃ­culo asignado aÃºn
   Usuario puede editar si es necesario
       â†“
4. MÃ“DULO REPARTOS â†’ CALENDARIO:
   Ir a vista de Calendario
   Entrar al DÃA que seleccionaste en cotizador
   Ver capacidad del dÃ­a (pedidos y kilos)
       â†“
5. MÃ“DULO REPARTOS â†’ VISTA DEL DÃA:
   Vistas disponibles (3 opciones):
     - Lista de pedidos
     - Agrupar por ciudad
     - Agrupar por vehÃ­culo â† AQUÃ se asignan pedidos a vehÃ­culos
       â†“
6. ASIGNACIÃ“N VEHÃCULO:
   Seleccionar pedido
   Asignar a vehÃ­culo especÃ­fico (CamiÃ³n A, B, etc.)
   Acomodar orden de visitas dentro del vehÃ­culo
       â†“
7. EXPORTAR HOJA DE REPARTO:
   Descargar documento Word
   Con detalles y orden de visitas
   Para que chofer siga el orden exacto
       â†“
8. REPARTIDOR:
   Entrega pedido al cliente
       â†“
9. MÃ“DULO VENTAS (Post-entrega):
   Buscar pedido entregado
   Click "Editar" si hubo cambios:
     - Ajustar cantidades (ej: entregÃ³ 9 de 10)
     - Corregir descuentos olvidados
     - Sumar/restar productos de Ãºltimo momento
   Sistema genera AJUSTE en cuenta corriente
   Registrar mÃ©todo de pago (efectivo/digital/mixto)
   Cambiar estado â†’ "Entregado"
       â†“
10. RESULTADO FINAL:
    Pedido queda en VENTAS como "Entregado"
    Con datos reales de lo vendido
    MÃ©todo de pago registrado
    AuditorÃ­a completa de cambios</code></pre>

            <h4>MODO FÃBRICA (Flujo con registro de pago opcional):</h4>
            <pre><code>1. COTIZADOR:
   Usuario selecciona modo FÃBRICA
   Agrega productos
   (Opcional) Selecciona cliente o "Cliente sin nombre"
   (Opcional) Aplica descuentos
   <strong>(NUEVO) (Opcional) Registra mÃ©todo de pago:</strong>
     - Marca: Efectivo | Digital | Ambos
     - Monto recibido: Puede ser completo, parcial, o sin pago
   Confirma pedido
       â†“
2. SISTEMA:
   Estado cambia a "Entregado" DIRECTO
   Stock se descuenta
   Cargo en cuenta corriente (si hay cliente)
   <strong>SI registrÃ³ pago:</strong>
     - Pago en CC: -Monto recibido
     - Pedido guarda: metodo_pago y monto_pagado
     - Saldo: Total - Monto recibido
   <strong>SI NO registrÃ³ pago:</strong>
     - Solo cargo en CC
     - Pedido: metodo_pago = null
     - Saldo: Total (cliente debe)
       â†“
3. MÃ“DULO VENTAS:
   Pedido aparece con filtro "Entregado"
   Muestra: Total | Pagado | Pendiente

   Ejemplos:
   - Pedido $100k, pagado $30k â†’ Pendiente $70k
   - Pedido $100k, sin pago â†’ Pendiente $100k
   - Pedido $100k, pagado $100k â†’ Pendiente $0

   Usuario puede editar si hubo cambios:
     - Ajustar cantidades
     - Corregir precios
     - Modificar productos
   Sistema genera AJUSTE en cuenta corriente

   <strong>Registrar/modificar mÃ©todo de pago:</strong>
     - Si NO se registrÃ³ en cotizador â†’ Registrar ahora
     - Si ya se registrÃ³ â†’ Puede modificar
       â†“
4. RESULTADO FINAL:
   Venta de fÃ¡brica registrada con datos reales
   MÃ©todo de pago: Registrado en cotizador O en ventas
   Saldo cliente: Refleja pago(s) realizado(s)</code></pre>

            <h3 id="interaccion-modulos">InteracciÃ³n entre mÃ³dulos:</h3>
            <p><strong>COTIZADOR â†” VENTAS â†” REPARTOS</strong></p>

            <table>
                <tr>
                    <th>MÃ³dulo</th>
                    <th>Responsabilidad</th>
                    <th>Estados que maneja</th>
                </tr>
                <tr>
                    <td><strong>COTIZADOR</strong></td>
                    <td>
                        â€¢ Crear pedidos<br>
                        â€¢ Asignar fecha (modo reparto)<br>
                        â€¢ <strong>Registrar pagos al momento (modo fÃ¡brica)</strong><br>
                        â€¢ Generar cargo en CC<br>
                        â€¢ Generar pago en CC (si se registrÃ³)<br>
                        â€¢ Descontar stock
                    </td>
                    <td>Borrador â†’ En trÃ¡nsito/Entregado</td>
                </tr>
                <tr>
                    <td><strong>VENTAS</strong></td>
                    <td>
                        â€¢ Ver todos los pedidos<br>
                        â€¢ Editar pedidos (incluso entregados)<br>
                        â€¢ Cambiar estados<br>
                        â€¢ Registrar mÃ©todos de pago<br>
                        â€¢ Generar ajustes en CC<br>
                        â€¢ Exportar reportes
                    </td>
                    <td>En trÃ¡nsito â†” Entregado</td>
                </tr>
                <tr>
                    <td><strong>REPARTOS</strong></td>
                    <td>
                        â€¢ Visualizar calendario<br>
                        â€¢ Asignar vehÃ­culos<br>
                        â€¢ Ordenar visitas<br>
                        â€¢ Exportar hojas de reparto<br>
                        â€¢ NO cambia estados
                    </td>
                    <td>Solo lectura (En trÃ¡nsito)</td>
                </tr>
            </table>

            <p><strong>Flujo de datos:</strong></p>
            <pre><code>COTIZADOR crea pedido
    â†“
VENTAS muestra pedido (editable)
    â†“
REPARTOS visualiza pedido para asignar vehÃ­culo
    â†“
VENTAS marca como entregado + registra pago
    â†“
Dato final queda en VENTAS</code></pre>
        </section>

        <section id="flujos-detallados">
            <h2>5. Flujos Detallados</h2>

            <h3>Flujo 6.1 (actualizado): Cotizar venta fÃ¡brica</h3>
            <ol>
                <li>Usuario abre "Nueva CotizaciÃ³n"</li>
                <li>Selecciona switch modo <strong>FÃBRICA</strong></li>
                <li>Busca y agrega productos</li>
                <li>(Opcional) Selecciona cliente o deja "Cliente sin nombre"</li>
                <li>(Opcional) Ajusta descuentos, notas</li>
                <li>Confirma el pedido</li>
                <li><strong>El pedido queda en estado "Entregado"</strong></li>
                <li>El stock se descuenta</li>
                <li>Si hay cliente, se genera cargo en cuenta corriente</li>
                <li><strong>El pedido aparece automÃ¡ticamente en mÃ³dulo VENTAS con filtro "Entregado"</strong></li>
                <li>El sistema vuelve a modo "nueva cotizaciÃ³n"</li>
            </ol>

            <p><strong>NUEVO</strong>: DespuÃ©s, desde mÃ³dulo VENTAS:</p>
            <ol start="12">
                <li>Usuario puede editar el pedido si hubo cambios</li>
                <li>Registra mÃ©todo de pago (efectivo/digital)</li>
            </ol>

            <h3>Flujo 6.2 (actualizado): Cotizar pedido reparto</h3>
            <ol>
                <li>Usuario abre "Nueva CotizaciÃ³n"</li>
                <li>Selecciona switch modo <strong>REPARTO</strong></li>
                <li>Busca y agrega productos</li>
                <li>Selecciona cliente</li>
                <li>(Opcional) Ajusta descuentos, notas</li>
                <li>Confirma el pedido</li>
                <li>Se abre calendario para elegir fecha de entrega (lunes-viernes)</li>
                <li>Selecciona fecha (si no selecciona, toma fecha actual)</li>
                <li><strong>El pedido queda en estado "En trÃ¡nsito" con fecha asignada</strong></li>
                <li>El stock se descuenta</li>
                <li>Se genera cargo en cuenta corriente</li>
                <li><strong>El pedido aparece en mÃ³dulo VENTAS con filtro "En trÃ¡nsito"</strong></li>
                <li>El sistema vuelve a modo "nueva cotizaciÃ³n"</li>
            </ol>

            <p><strong>NUEVO</strong>: DespuÃ©s:</p>
            <ol start="14">
                <li>En mÃ³dulo Repartos: Se asigna a vehÃ­culo</li>
                <li>Repartidor entrega el pedido</li>
                <li>En mÃ³dulo VENTAS: Se marca como "Entregado"</li>
                <li>Se editan cantidades/precios si hubo cambios</li>
                <li>Se registra mÃ©todo de pago</li>
            </ol>

            <h3>Flujo 6.26 (NUEVO): Gestionar pedidos en Ventas</h3>
            <p><strong>Objetivo</strong>: Ver, filtrar, editar y gestionar todos los pedidos post-cotizaciÃ³n</p>
            <ol>
                <li>Usuario abre mÃ³dulo "Ventas"</li>
                <li>Ve listado de TODOS los pedidos (en trÃ¡nsito + entregados)</li>
                <li>Aplica filtros segÃºn necesidad:
                    <ul>
                        <li>Estado: En trÃ¡nsito | Entregado</li>
                        <li>PerÃ­odo: 10/12 - 15/12</li>
                        <li>Tipo: Reparto</li>
                        <li>VehÃ­culo: CamiÃ³n A</li>
                    </ul>
                </li>
                <li>Ve totales actualizados segÃºn filtros</li>
                <li><strong>Para cada pedido puede</strong>:
                    <ul>
                        <li>Ver detalle completo</li>
                        <li>Editar (corregir cantidades, precios, productos)</li>
                        <li>Cambiar estado (En trÃ¡nsito â†” Entregado)</li>
                        <li>Registrar mÃ©todo de pago</li>
                        <li>Eliminar (con reintegro stock)</li>
                    </ul>
                </li>
            </ol>

            <h3>Flujo 6.27 (NUEVO): Pulir pedido post-entrega</h3>
            <p><strong>Objetivo</strong>: Ajustar pedido despuÃ©s de la entrega real</p>
            <p><strong>Caso de uso</strong>: Repartidor entregÃ³ 9 de 10 productos planificados</p>
            <ol>
                <li>Usuario abre mÃ³dulo "Ventas"</li>
                <li>Filtra por: Entregados hoy</li>
                <li>Busca el pedido especÃ­fico</li>
                <li>Click "Editar"</li>
                <li>Se abre cotizador en modo ediciÃ³n</li>
                <li><strong>Modifica cantidades</strong>:
                    <ul>
                        <li>Producto A: TenÃ­a 10 â†’ Cambia a 9</li>
                    </ul>
                </li>
                <li>Guarda cambios</li>
                <li>Sistema (procesos automÃ¡ticos):
                    <ul>
                        <li>Reintegra 1 unidad al stock</li>
                        <li>Recalcula total del pedido: $10.000 â†’ $9.000</li>
                        <li><strong>Genera AJUSTE en cuenta corriente</strong>: -$1.000</li>
                        <li>Cargo original NO se modifica (trazabilidad)</li>
                        <li><em>(Ver secciÃ³n 3.8.6 para detalles de ajustes en CC)</em></li>
                    </ul>
                </li>
                <li>Usuario registra mÃ©todo de pago:
                    <ul>
                        <li>Click icono pago</li>
                        <li>Selecciona "Efectivo"</li>
                        <li>Guarda</li>
                    </ul>
                </li>
                <li>Pedido queda pulido con datos reales</li>
            </ol>

            <h3>Flujo 6.28 (NUEVO): Contrastar ventas sistema vs realidad</h3>
            <p><strong>Objetivo</strong>: Verificar que los totales del sistema coincidan con ingresos reales</p>
            <ol>
                <li>Usuario abre mÃ³dulo "Ventas"</li>
                <li>Filtra por semana: 10-16 diciembre</li>
                <li>Ve totales en panel superior:
                    <ul>
                        <li>Monto total: $245.000</li>
                        <li>Efectivo: $180.000</li>
                        <li>Digital: $65.000</li>
                    </ul>
                </li>
                <li>Compara con:
                    <ul>
                        <li>Caja fÃ­sica real: $180.000 âœ…</li>
                        <li>MercadoPago: $65.000 âœ…</li>
                    </ul>
                </li>
                <li>Si hay discrepancia:
                    <ul>
                        <li>Revisa pedidos sin mÃ©todo de pago registrado</li>
                        <li>Busca pedidos marcados como entregados pero no pagados</li>
                        <li>Edita pedidos con errores</li>
                    </ul>
                </li>
                <li>Exporta reporte Excel para contador</li>
            </ol>
        </section>

        <section id="especificacion-ventas">
            <h2>6. EspecificaciÃ³n MÃ³dulo Ventas</h2>

            <h3>3.8 Ventas - Nueva especificaciÃ³n</h3>
            <p><strong>DescripciÃ³n</strong>: MÃ³dulo central para gestiÃ³n, ediciÃ³n y seguimiento de todos los pedidos
                post-cotizaciÃ³n.</p>

            <h3>3.8.1 Funcionalidad principal</h3>
            <p><strong>Muestra</strong>: TODOS los pedidos (sin importar estado):</p>
            <ul>
                <li>En trÃ¡nsito (con fecha asignada)</li>
                <li>Entregados (fÃ¡brica o reparto)</li>
            </ul>

            <p><strong>Permite</strong>:</p>
            <ul>
                <li>âœ… Filtrar por mÃºltiples criterios</li>
                <li>âœ… Editar pedidos (incluso entregados)</li>
                <li>âœ… Cambiar estados manualmente</li>
                <li>âœ… Registrar/modificar mÃ©todos de pago</li>
                <li>âœ… Ver totales y estadÃ­sticas</li>
                <li>âœ… Exportar reportes</li>
            </ul>

            <h3>3.8.2 Filtros disponibles</h3>
            <table>
                <tr>
                    <th>Filtro</th>
                    <th>Opciones</th>
                    <th>DescripciÃ³n</th>
                </tr>
                <tr>
                    <td><strong>Estado</strong></td>
                    <td>En trÃ¡nsito | Entregado | Todos</td>
                    <td>Filtra por estado actual</td>
                </tr>
                <tr>
                    <td><strong>PerÃ­odo</strong></td>
                    <td>Desde-Hasta (fechas)</td>
                    <td>Rango de fechas de entrega</td>
                </tr>
                <tr>
                    <td><strong>Tipo</strong></td>
                    <td>FÃ¡brica | Reparto | Todos</td>
                    <td>Canal de venta</td>
                </tr>
                <tr>
                    <td><strong>VehÃ­culo</strong></td>
                    <td>CamiÃ³n A | CamiÃ³n B | Sin vehÃ­culo | Todos</td>
                    <td>Solo para repartos</td>
                </tr>
                <tr>
                    <td><strong>MÃ©todo pago</strong></td>
                    <td>Efectivo | Digital | Mixto | Sin registrar</td>
                    <td>CÃ³mo pagÃ³ el cliente</td>
                </tr>
            </table>

            <p><strong>CombinaciÃ³n</strong>: Todos los filtros son combinables</p>
            <p><strong>Ejemplo</strong>: "Pedidos entregados entre 10-15/12, tipo reparto, vehÃ­culo CamiÃ³n A, pagados en
                efectivo"</p>

            <h3>3.8.3 Vista listado</h3>
            <p><strong>Columnas tabla</strong>:</p>
            <ul>
                <li># Pedido</li>
                <li>Fecha entrega (o fecha asignada si en trÃ¡nsito)</li>
                <li>DirecciÃ³n</li>
                <li>Estado (badge: En trÃ¡nsito / Entregado)</li>
                <li>Tipo (badge: FÃ¡brica / Reparto)</li>
                <li>VehÃ­culo (si aplica)</li>
                <li>Monto total</li>
                <li>MÃ©todo pago (icon: ğŸ’µ efectivo / ğŸ’³ digital / âš ï¸ sin registrar)</li>
                <li>Acciones (Ver detalle, Editar, Cambiar estado)</li>
            </ul>

            <p><strong>Ordenamiento</strong>: Por defecto por fecha descendente (mÃ¡s recientes primero)</p>

            <p><strong>Fila de totales</strong> (NUEVO - Dic 2025):</p>
            <ul>
                <li>âœ… <strong>UbicaciÃ³n</strong>: Al final de la tabla de pedidos</li>
                <li>âœ… <strong>PropÃ³sito</strong>: Control financiero de repartos (ver cuÃ¡nto $ debe traer un vehÃ­culo)</li>
                <li>âœ… <strong>Se actualiza dinÃ¡micamente</strong> segÃºn filtros aplicados</li>
                <li>âœ… <strong>Columnas mostradas</strong>:
                    <ul>
                        <li><strong>Total pedidos</strong>: Cantidad de pedidos filtrados</li>
                        <li><strong>Total monto</strong>: Suma de todos los montos (formato: $XXX.XXX)</li>
                        <li><strong>Total efectivo</strong>: Suma de pagos en efectivo (si filtro por mÃ©todo pago)</li>
                        <li><strong>Total digital</strong>: Suma de pagos digitales (si filtro por mÃ©todo pago)</li>
                    </ul>
                </li>
            </ul>

            <p><strong>Ejemplo de uso</strong>:</p>
            <pre><code>Filtro aplicado: VehÃ­culo "CamiÃ³n A" + Fecha "27/12/2025"
Tabla muestra: 8 pedidos

FILA FINAL:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TOTAL: 8 pedidos | $285.000 | ğŸ’µ $180.000 | ğŸ’³ $105.000 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Uso: El chofer debe traer $180.000 en efectivo + comprobantes de $105.000 digital</code></pre>

            <p><strong>Notas sobre pestaÃ±a BORRADORES</strong>:</p>
            <ul>
                <li>âœ… <strong>Columna "Fecha"</strong>: En la pestaÃ±a Borradores, la columna se llama simplemente <strong>"Fecha"</strong> (no "Fecha de creaciÃ³n")</li>
                <li>âœ… Muestra la fecha en que se creÃ³ el borrador</li>
            </ul>

            <h3>3.8.4 Detalle de pedido</h3>
            <p>Al hacer click en un pedido, se abre modal/pÃ¡gina con:</p>
            <p><strong>InformaciÃ³n general</strong>:</p>
            <ul>
                <li># Pedido</li>
                <li>Cliente (nombre, direcciÃ³n, telÃ©fono)</li>
                <li>Estado actual</li>
                <li>Tipo (FÃ¡brica/Reparto)</li>
                <li>Fecha creaciÃ³n | Fecha entrega</li>
                <li>VehÃ­culo asignado (si aplica)</li>
            </ul>

            <p><strong>Productos</strong>:</p>
            <ul>
                <li>Lista de productos con cantidades y precios</li>
                <li>Subtotal</li>
                <li>Descuentos aplicados</li>
                <li>Ajustes (+/-)</li>
                <li><strong>Total</strong></li>
            </ul>

            <p><strong>MÃ©todo de pago</strong>: (NUEVO - OBLIGATORIO)</p>
            <ul>
                <li>Checkboxes mÃºltiple selecciÃ³n: Efectivo | Digital (MercadoPago/Transferencia)</li>
                <li>Permite seleccionar uno o ambos</li>
                <li>Si selecciona ambos: Campos para dividir monto
                    <ul>
                        <li>Efectivo: $X</li>
                        <li>Digital: $X</li>
                        <li>ValidaciÃ³n: Suma debe igualar total pedido</li>
                    </ul>
                </li>
                <li>Notas sobre el pago (opcional)</li>
            </ul>

            <p id="historial-cambios"><strong>Historial de cambios</strong>: (OBLIGATORIO - AuditorÃ­a)</p>
            <ul>
                <li><strong>Registro automÃ¡tico</strong> de todas las modificaciones post-entrega</li>
                <li><strong>Campos registrados</strong>:
                    <ul>
                        <li>Usuario que editÃ³ (nombre completo + ID)</li>
                        <li>Fecha/hora exacta del cambio</li>
                        <li>Campo modificado (ej: "Cantidad Producto A")</li>
                        <li>Valor anterior â†’ Valor nuevo</li>
                        <li>IP del usuario (seguridad)</li>
                        <li>(Opcional) RazÃ³n del cambio (campo texto libre)</li>
                    </ul>
                </li>
                <li><strong>VisualizaciÃ³n</strong>: LÃ­nea de tiempo cronolÃ³gica</li>
                <li><strong>PropÃ³sito</strong>: Trazabilidad total y auditorÃ­a fiscal</li>
            </ul>

            <p><strong>Acciones disponibles</strong>:</p>
            <ul>
                <li>âœï¸ Editar pedido (abre cotizador en modo ediciÃ³n)</li>
                <li>ğŸ”„ Cambiar estado (En trÃ¡nsito â†” Entregado)</li>
                <li>ğŸ’° Registrar/modificar mÃ©todo de pago</li>
                <li>ğŸ—‘ï¸ Eliminar pedido (con confirmaciÃ³n + reintegro stock)</li>
            </ul>

            <h3>3.8.5 Editar pedido desde Ventas</h3>
            <p><strong>Funcionalidad</strong>: Poder modificar pedidos incluso despuÃ©s de marcar como "entregado",
                cuando el repartidor vuelve con novedades.</p>

            <p><strong>Casos de uso</strong>:</p>
            <ol>
                <li>Cliente devolviÃ³ 1 producto â†’ Restar cantidad</li>
                <li>Se olvidÃ³ aplicar descuento â†’ Aplicar descuento retroactivo</li>
                <li>Cliente comprÃ³ 2 productos extra â†’ Sumar productos</li>
                <li>Error en precio â†’ Corregir precio unitario</li>
            </ol>

            <p><strong>Flujo ediciÃ³n</strong>:</p>
            <pre><code>MÃ³dulo VENTAS â†’ Selecciona pedido â†’ Click "Editar"
                            â†“
                Abre cotizador en modo ediciÃ³n
                (mismo que editar desde cualquier mÃ³dulo)
                            â†“
                Modifica productos/cantidades/precios
                            â†“
                Guarda cambios
                            â†“
    Stock se ajusta automÃ¡ticamente
    Cuenta corriente se actualiza (si aplica)
                            â†“
        Vuelve al mÃ³dulo VENTAS</code></pre>

            <h4><strong>Cambiar tipo de pedido (REPARTO â†” FÃBRICA)</strong> â­ NUEVO (Dic 2025)</h4>
            <p><strong>Funcionalidad</strong>: Permitir cambiar el tipo de un pedido existente entre REPARTO y FÃBRICA.</p>

            <p><strong>Acceso</strong>:</p>
            <ul>
                <li>Desde el detalle del pedido en VENTAS</li>
                <li>BotÃ³n: <strong>[ğŸ”„ Cambiar tipo]</strong></li>
            </ul>

            <p><strong>Modal de confirmaciÃ³n</strong>:</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cambiar tipo de pedido #155          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  Tipo actual: ğŸšš REPARTO               â”‚
â”‚  Nuevo tipo:  ğŸ­ FÃBRICA               â”‚
â”‚                                        â”‚
â”‚  âš ï¸ Cambios que se aplicarÃ¡n:         â”‚
â”‚  â€¢ Estado cambiarÃ¡ a "Entregado"      â”‚
â”‚  â€¢ Se eliminarÃ¡ asignaciÃ³n de vehÃ­culoâ”‚
â”‚  â€¢ Fecha de entrega = Hoy             â”‚
â”‚                                        â”‚
â”‚  [Cancelar]  [Confirmar cambio]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>Efectos al cambiar de REPARTO â†’ FÃBRICA</strong>:</p>
            <ul>
                <li>âœ… Estado: "En trÃ¡nsito" â†’ "Entregado"</li>
                <li>âœ… Fecha entrega: Se asigna fecha actual</li>
                <li>âœ… VehÃ­culo asignado: Se elimina (vuelve a NULL)</li>
                <li>âœ… Aparece en filtro "FÃ¡brica" en VENTAS</li>
            </ul>

            <p><strong>Efectos al cambiar de FÃBRICA â†’ REPARTO</strong>:</p>
            <ul>
                <li>âœ… Estado: "Entregado" â†’ "En trÃ¡nsito"</li>
                <li>âœ… Abre calendario para seleccionar fecha de reparto</li>
                <li>âœ… VehÃ­culo: Sin asignar (se asigna desde REPARTOS)</li>
                <li>âœ… Aparece en filtro "Reparto" y en Calendario dÃ­a seleccionado</li>
            </ul>

            <p><strong>Validaciones</strong>:</p>
            <ul>
                <li>âš ï¸ Si el pedido tiene mÃ©todo de pago registrado, se mantiene</li>
                <li>âš ï¸ Si hay ajustes en cuenta corriente, se mantienen intactos</li>
                <li>âš ï¸ El historial de cambios registra: Usuario, fecha/hora, tipo anterior â†’ tipo nuevo</li>
            </ul>

            <h3 id="cuenta-corriente">3.8.6 Impacto en Cuenta Corriente al editar pedidos</h3>

            <p><strong>Cuando se edita un pedido desde VENTAS</strong>, el sistema genera automÃ¡ticamente <strong>ajustes en la Cuenta Corriente</strong> del cliente.</p>

            <h4>Regla crÃ­tica:</h4>
            <blockquote>
                El cargo original del pedido NUNCA se modifica. Siempre se crea un NUEVO movimiento tipo "Ajuste" con la diferencia entre el total anterior y el nuevo.
            </blockquote>

            <h4>Ejemplo simplificado:</h4>
            <pre><code>Pedido original: $10.000 (10 unidades)
Cliente devolviÃ³ 1 unidad
Nuevo total: $9.000

Sistema AUTOMÃTICO:
âœ… Reintegra 1 unidad al stock
âœ… Crea AJUSTE en cuenta corriente: -$1.000
âœ… Cargo original permanece intacto (auditorÃ­a)
âœ… Saldo final: -$9.000</code></pre>

            <div class="note" style="border-left: 4px solid #17a2b8; background: #d1ecf1; padding: 1rem; margin: 1.5rem 0;">
                <p><strong>ğŸ“„ EspecificaciÃ³n completa en mÃ³dulo Cuenta Corriente</strong></p>
                <p>Para detalles tÃ©cnicos sobre ajustes por ediciÃ³n de pedidos, validaciones, campos del ajuste, y casos de uso completos, ver:</p>
                <p><a href="cuenta-corriente.html#ajustes-edicion-pedidos" style="color: #0056b3; font-weight: 600;">â†’ MÃ³dulo Cuenta Corriente - SecciÃ³n 8: Ajustes por EdiciÃ³n de Pedidos</a></p>
            </div>

            <h3>3.8.7 Registrar mÃ©todo de pago</h3>
            <p><strong>Campo nuevo en pedidos</strong>: <code>metodo_pago</code></p>
            <p><strong>Opciones</strong> (selecciÃ³n mÃºltiple):</p>
            <ul>
                <li><strong>Efectivo</strong>: Cliente pagÃ³ en efectivo</li>
                <li><strong>Digital</strong>: MercadoPago, transferencia, dÃ©bito, crÃ©dito</li>
                <li><strong>Ambos</strong> (Efectivo + Digital): CombinaciÃ³n de mÃ©todos
                    <ul>
                        <li>Requiere campos adicionales: <code>monto_efectivo</code>, <code>monto_digital</code></li>
                        <li>ValidaciÃ³n: <code>monto_efectivo + monto_digital = total_pedido</code></li>
                    </ul>
                </li>
                <li><strong>Sin registrar</strong>: Estado temporal hasta que se registre (solo para pedidos en
                    trÃ¡nsito)</li>
            </ul>

            <div class="note" style="border-left: 4px solid #28a745; background: #d4edda; padding: 1rem; margin: 1.5rem 0;">
                <p><strong>ğŸ”„ ACTUALIZACIÃ“N: Sistema hÃ­brido de registro de pagos (Dic 2025)</strong></p>
                <p>Los pagos se pueden registrar desde <strong>AMBOS mÃ³dulos</strong> (VENTAS y Cuenta Corriente) con <strong>sincronizaciÃ³n automÃ¡tica</strong> para evitar duplicaciÃ³n.</p>
                <p><strong>Motivo</strong>: Operadores controlando repartos necesitan registrar pagos masivamente desde la tabla de ventas sin ir cliente por cliente a Cuenta Corriente. Al mismo tiempo, en casos puntuales se necesita registrar desde el perfil del cliente.</p>
            </div>

            <p><strong>Flujo opciÃ³n 1 - Registro desde VENTAS</strong> (Caso mÃ¡s comÃºn):</p>
            <pre><code>MÃ³dulo VENTAS â†’ Pedido en trÃ¡nsito â†’ Click "Marcar como Entregado"
                            â†“
                Modal "Registrar entrega y pago"
                            â†“
                Campos obligatorios:
                - Total pedido: $100,000
                - Monto recibido: [______] (puede ser < total para pago parcial)
                - MÃ©todo: â˜ Efectivo | â˜ Digital | â˜ Ambos
                - Nota (opcional)
                            â†“
            Estado cambia a "ENTREGADO"
            + Se registra AUTOMÃTICAMENTE en Cuenta Corriente
                            â†“
                Sistema crea movimiento en CC:
                - Tipo: Pago
                - DescripciÃ³n: "Pago pedido #XXX"
                - Monto: $100,000
                - MÃ©todo: Efectivo/Digital/Mixto
                - Origen: VENTAS
                - Usuario: [Operador actual]
                - Timestamp: [Fecha/hora actual]</code></pre>

            <p><strong>Flujo opciÃ³n 2 - Registro desde CUENTA CORRIENTE</strong> (Casos puntuales):</p>
            <pre><code>MÃ³dulo CLIENTES â†’ Cliente â†’ Tab "Cuenta Corriente"
                            â†“
                Click [+ Registrar pago]
                            â†“
                Modal "Registrar Pago"
                            â†“
        Selecciona tipo:
        â—‹ Pago genÃ©rico (reduce saldo sin asociar a pedido)
        â—‹ Pago a pedido especÃ­fico #XXX
                            â†“
        Si elige "especÃ­fico" â†’ Se actualiza <code>pedido.monto_pagado</code>
        + Columna "Pagado" en VENTAS se sincroniza</code></pre>

            <p><strong>ğŸ”„ SincronizaciÃ³n automÃ¡tica bidireccional</strong>:</p>
            <ul>
                <li>âœ… <strong>VENTAS â†’ CC</strong>: Pago registrado en VENTAS se crea automÃ¡ticamente en Cuenta Corriente</li>
                <li>âœ… <strong>CC â†’ VENTAS</strong>: Pago a pedido especÃ­fico desde CC actualiza columna "Pagado" en tabla VENTAS</li>
                <li>âœ… <strong>Anti-duplicados</strong>: Sistema verifica si el pedido ya tiene pago registrado antes de crear nuevo movimiento</li>
                <li>âœ… <strong>Trazabilidad</strong>: Cada pago registra origen (VENTAS o CC), usuario y timestamp</li>
                <li>âœ… <strong>Consistencia</strong>: Ambos mÃ³dulos muestran siempre la misma informaciÃ³n actualizada</li>
            </ul>

            <p><strong>RelaciÃ³n con Cuenta Corriente</strong>:</p>
            <ul>
                <li>âœ… El cargo del pedido se registra al confirmar (COTIZADOR o BORRADOR)</li>
                <li>âœ… <strong>Los pagos se pueden registrar desde VENTAS o Cuenta Corriente</strong></li>
                <li>âœ… El pago puede ser genÃ©rico (reduce saldo) o especÃ­fico (actualiza <code>pedido.monto_pagado</code>)</li>
                <li>âœ… Permite pagos parciales mÃºltiples al mismo pedido</li>
                <li>âœ… SincronizaciÃ³n automÃ¡tica evita duplicaciÃ³n y mantiene consistencia</li>
                <li><em>Ver <a href="cuenta-corriente.html">MÃ³dulo Cuenta Corriente</a> para detalles del sistema hÃ­brido</em></li>
            </ul>

            <h3>3.8.7.1 Pagos parciales (modo REPARTO y FÃBRICA)</h3>

            <p><strong>Flexibilidad total</strong>: El sistema permite pagos parciales en AMBOS modos (REPARTO y FÃBRICA).</p>

            <p><strong>Escenario comÃºn - Modo REPARTO</strong>:</p>
            <pre><code>Pedido reparto: $100,000
Repartidor entrega
Cliente solo tiene: $60,000

En VENTAS â†’ Marcar como entregado:
Modal "Registrar pago":
  Total pedido: $100,000
  Monto recibido: [$60,000]  â† Usuario puede ingresar menos

  âš ï¸ Pago parcial detectado
  Saldo pendiente: $40,000
  (quedarÃ¡ en cuenta corriente)

Resultado:
- pedido.total = $100,000
- pedido.monto_pagado = $60,000
- Cuenta Corriente: Cargo +$100k, Pago -$60k
- Saldo cliente: -$40,000 (debe)</code></pre>

            <p><strong>Pago mixto parcial</strong>:</p>
            <pre><code>Total pedido: $100,000
Usuario registra:
  â˜‘ Efectivo: $30,000
  â˜‘ Digital:  $20,000
  Total recibido: $50,000

Sistema:
- Pago efectivo CC: -$30,000
- Pago digital CC: -$20,000
- Saldo pendiente: $50,000</code></pre>

            <h3>3.8.7.2 Pagos asociados vs Pagos genÃ©ricos â­ CRÃTICO</h3>

            <div class="note" style="border-left: 4px solid #dc3545; background: #f8d7da; padding: 1rem; margin: 1.5rem 0;">
                <p><strong>âš ï¸ CONCEPTO FUNDAMENTAL DEL SISTEMA FINANCIERO</strong></p>
                <p>Es crÃ­tico entender la diferencia entre pagos asociados a pedidos y pagos genÃ©ricos.</p>
            </div>

            <h4>Tipos de pagos en el sistema:</h4>

            <table>
                <tr>
                    <th>Tipo</th>
                    <th>DÃ³nde se registra</th>
                    <th>Efecto en pedido</th>
                    <th>Efecto en CC</th>
                </tr>
                <tr>
                    <td><strong>Pago ASOCIADO</strong></td>
                    <td>
                        â€¢ Cotizador (modo fÃ¡brica - al confirmar)<br>
                        â€¢ CC â†’ OpciÃ³n "Pago a pedido especÃ­fico"
                    </td>
                    <td>âœ… Actualiza <code>monto_pagado</code></td>
                    <td>âœ… Reduce saldo</td>
                </tr>
                <tr>
                    <td><strong>Pago GENÃ‰RICO</strong></td>
                    <td>
                        â€¢ Cuenta Corriente<br>
                        â€¢ OpciÃ³n: "Pago genÃ©rico"
                    </td>
                    <td>âŒ NO actualiza pedido</td>
                    <td>âœ… Reduce saldo</td>
                </tr>
            </table>

            <h4>Â¿Por quÃ© esta diferencia?</h4>
            <p><strong>Realidad del negocio</strong>: Los clientes NO siempre especifican "esto es para el pedido #100".</p>
            <p>Muchas veces dicen: <em>"Te transfiero $50.000"</em> (sin especificar a quÃ© pedido corresponde).</p>

            <h4>Ejemplo completo:</h4>

            <pre><code>DÃ­a 1 - COTIZADOR (Venta fÃ¡brica):
Cliente: Av. San MartÃ­n 1234
Pedido #100: $100,000
Usuario registra pago parcial: $30,000 efectivo
â†’ Sistema:
  - pedido.monto_pagado = $30,000 âœ… (asociado al pedido)
  - CC: Cargo +$100k, Pago -$30k
  - Saldo cliente: -$70,000

En VENTAS se ve:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ #100 â”‚ $100k â”‚ $30k âš ï¸ â”‚ ğŸ’µ â”‚ Entregado â”‚
â”‚      â”‚ Total â”‚ Pagado  â”‚    â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

DÃ­a 3 - CUENTA CORRIENTE (Pago genÃ©rico):
Cliente transfiere sin especificar pedido
Usuario registra: $40,000 digital â†’ OpciÃ³n: "Pago genÃ©rico"
â†’ Sistema:
  - pedido.monto_pagado = SIN CAMBIOS ($30k) âŒ
  - CC: Pago genÃ©rico -$40k
  - Saldo cliente: -$30,000

En VENTAS SIGUE igual:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ #100 â”‚ $100k â”‚ $30k âš ï¸ â”‚ ğŸ’µ â”‚ Entregado â”‚
â”‚      â”‚ Total â”‚ Pagado  â”‚    â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸ El pedido NO cambiÃ³ porque el pago fue GENÃ‰RICO

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

DÃ­a 5 - CUENTA CORRIENTE (Pago especÃ­fico):
Cliente paga resto diciendo "es para el pedido #100"
Usuario registra: $30,000 digital
â†’ OpciÃ³n: "Pedido especÃ­fico" â†’ Selecciona: Pedido #100
â†’ Sistema:
  - pedido.monto_pagado = $30k + $30k = $60k âœ… (asociado)
  - CC: Pago a pedido #100 -$30k
  - Saldo cliente: $0

En VENTAS AHORA SÃ cambia:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ #100 â”‚ $100k â”‚ $60k âš ï¸ â”‚ ğŸ’µğŸ’³â”‚ Entregado â”‚
â”‚      â”‚ Total â”‚ Pagado  â”‚     â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

IMPORTANTE: Falta $40k segÃºn el pedido, aunque el
cliente no deba nada (saldo $0) porque esos $40k
fueron un pago genÃ©rico no asociado al pedido.</code></pre>

            <h4>Regla de oro:</h4>
            <blockquote>
                <strong>Columna "Pagado" en VENTAS</strong> muestra SOLO los pagos ASOCIADOS directamente al pedido.
                <br><br>
                Los pagos genÃ©ricos NO aparecen en pedidos individuales, solo reducen el saldo total del cliente en Cuenta Corriente.
            </blockquote>

            <h4>Â¿CÃ³mo saber si el cliente debe dinero?</h4>
            <ul>
                <li><strong>Saldo Cuenta Corriente</strong>: Fuente de verdad del debe/haber total</li>
                <li><strong>Columna "Pagado" en pedidos</strong>: Informativo (pagos asociados a ese pedido especÃ­fico)</li>
            </ul>

            <p><strong>Caso de uso real</strong>:</p>
            <pre><code>Cliente tiene 3 pedidos:
- Pedido #100: Total $100k, Pagado $30k, Pendiente $70k
- Pedido #101: Total $50k,  Pagado $0,   Pendiente $50k
- Pedido #155: Total $80k,  Pagado $80k, Pendiente $0

Suma pendiente segÃºn pedidos: $120k

Cliente transfiere $100k (pago genÃ©rico)

Saldo CC: -$20k (debe solo $20k)

PERO los pedidos SIGUEN mostrando:
- #100: Pendiente $70k
- #101: Pendiente $50k
- #155: Pendiente $0

âš ï¸ Total pendiente en pedidos: $120k
âœ… Saldo real cliente: -$20k

El pago genÃ©rico de $100k redujo el saldo total pero
NO se distribuyÃ³ entre los pedidos individuales.</code></pre>

            <h3>3.8.7.3 Pedidos sin cliente (ventas casuales)</h3>

            <p><strong>Caso de uso</strong>: Cliente casual compra en fÃ¡brica sin registrarse en el sistema.</p>

            <p><strong>SoluciÃ³n</strong>: Cliente especial del sistema "Venta casual - Sin registro"</p>

            <h4>CaracterÃ­sticas:</h4>
            <ul>
                <li>Cliente ficticio creado por el sistema</li>
                <li>NO tiene cuenta corriente activa (o siempre en $0)</li>
                <li>Solo para ventas de fÃ¡brica (modo FÃBRICA)</li>
                <li>NO permite ventas fiadas (pago obligatorio completo)</li>
            </ul>

            <h4>Validaciones especiales:</h4>
            <pre><code>En COTIZADOR modo FÃBRICA:
SI cliente = "Sin registro":
  â†’ MÃ©todo de pago: OBLIGATORIO
  â†’ Monto debe = Total pedido (no permite parciales)
  â†’ No permite "sin pago" (fiado)
  â†’ No genera cargo en Cuenta Corriente</code></pre>

            <h4>Vista en VENTAS:</h4>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ #    â”‚ Fecha â”‚ Cliente        â”‚ Total â”‚ Estado    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1240 â”‚ 20/12 â”‚ Sin registro   â”‚ $8k   â”‚ Entregado â”‚
â”‚ 1241 â”‚ 20/12 â”‚ Av. Mitre 567  â”‚ $50k  â”‚ Entregado â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CaracterÃ­sticas pedidos sin cliente:
- Siempre "Pagado" completo (obligatorio)
- NO permiten ediciÃ³n post-entrega
- NO afectan Cuenta Corriente
- Ãštiles para estadÃ­sticas de ventas</code></pre>

            <h4>Filtros en VENTAS:</h4>
            <ul>
                <li>Filtro "Cliente": Incluye opciÃ³n "Sin registro"</li>
                <li>Permite filtrar solo ventas casuales</li>
                <li>Ãštil para reportes de venta mostrador</li>
            </ul>

            <h3>3.8.8 Cambiar estado manualmente</h3>
            <p><strong>Estados disponibles en v2</strong>:</p>
            <ol>
                <li>Borrador (solo en cotizador)</li>
                <li><strong>En trÃ¡nsito</strong> (pedidos reparto con fecha asignada)</li>
                <li><strong>Entregado</strong> (pedidos fÃ¡brica directos + repartos completados)</li>
            </ol>

            <p><strong>Cambio de estado desde VENTAS</strong>:</p>
            <pre><code>Pedido "En trÃ¡nsito" â†’ Click "Marcar como entregado"
                        â†“
            Confirma acciÃ³n
                        â†“
        Estado cambia a "Entregado"
        Registra usuario + fecha/hora
                        â†“
OBLIGATORIO: Solicita mÃ©todo de pago si no estÃ¡ registrado
(No permite cerrar sin registrar mÃ©todo de pago)</code></pre>

            <p><strong>Cambio inverso</strong> (si es necesario):</p>
            <pre><code>Pedido "Entregado" â†’ Click "Volver a En trÃ¡nsito"
                        â†“
            Confirma acciÃ³n
                        â†“
        Estado cambia a "En trÃ¡nsito"</code></pre>

            <h3>3.8.8.1 Control y ajustes de reparto desde VENTAS</h3> â­ NUEVO (Dic 2025)
            <p><strong>Funcionalidad</strong>: Permitir hacer ajustes de asignaciÃ³n de vehÃ­culos y control de reparto directamente desde el mÃ³dulo VENTAS, sin tener que ir al mÃ³dulo REPARTOS.</p>

            <p><strong>Contexto</strong>:</p>
            <blockquote>
                "Hay gente que va a hacer el control desde Cuenta Corriente y otra desde Venta al momento de controlar el reparto" - Carlos, reuniÃ³n Dic 2025
            </blockquote>

            <p><strong>Problema identificado</strong>:</p>
            <p>Algunos operadores trabajan principalmente en el mÃ³dulo VENTAS para control financiero. Necesitan poder:</p>
            <ul>
                <li>Ver quÃ© pedidos estÃ¡n asignados a cada vehÃ­culo</li>
                <li>Reasignar pedidos entre vehÃ­culos sin salir de VENTAS</li>
                <li>Marcar pedidos como controlados</li>
                <li>Ver estado de reparto del dÃ­a</li>
            </ul>

            <p><strong>SoluciÃ³n: Panel de repartos en VENTAS</strong></p>

            <h4>Acceso rÃ¡pido desde VENTAS</h4>
            <p><strong>UbicaciÃ³n</strong>: Vista Calendario Semana â†’ Click en un dÃ­a</p>
            <pre><code>Calendario Semana (vista principal)
        â†“
Click en dÃ­a especÃ­fico (ej: "Lunes 23/12")
        â†“
Abre modal/panel lateral: "Repartos del dÃ­a 23/12"
        â†“
Muestra mismo contenido que mÃ³dulo REPARTOS â†’ Vista del dÃ­a</code></pre>

            <h4>Funcionalidades disponibles desde VENTAS</h4>
            <ul>
                <li>âœ… <strong>Ver pedidos por vehÃ­culo</strong>: Lista de pedidos asignados a cada camiÃ³n</li>
                <li>âœ… <strong>Ver pedidos sin asignar</strong>: Pedidos del dÃ­a sin vehÃ­culo</li>
                <li>âœ… <strong>Reasignar pedidos</strong>: Mover pedidos entre vehÃ­culos o desasignar</li>
                <li>âœ… <strong>Ver capacidad</strong>: Kg y cantidad de pedidos por vehÃ­culo</li>
                <li>âœ… <strong>Marcar como controlado</strong>: Badge de estado de control</li>
                <li>âœ… <strong>Link directo</strong>: BotÃ³n "Ver en REPARTOS" para vista completa</li>
            </ul>

            <h4>Vista modal "Repartos del dÃ­a"</h4>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“… Repartos del dÃ­a: Lunes 23/12/2025               â”‚
â”‚  [Ver en REPARTOS completo] [Cerrar]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  ğŸšš CamiÃ³n A (Mercedes Sprinter)                     â”‚
â”‚  ğŸ“¦ 5 pedidos | âš–ï¸ 180 kg de 3500 kg (5%)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ #155 - Av. San MartÃ­n 1234 - $80k          â”‚     â”‚
â”‚  â”‚ #156 - Calle Mitre 567 - $45k              â”‚     â”‚
â”‚  â”‚ [Mover a...â–¼] [Desasignar]                 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                      â”‚
â”‚  ğŸšš CamiÃ³n B (Toyota Hiace)                          â”‚
â”‚  ğŸ“¦ 3 pedidos | âš–ï¸ 95 kg de 1500 kg (6%)            â”‚
â”‚                                                      â”‚
â”‚  ğŸ“‹ Sin asignar (7 pedidos)                          â”‚
â”‚  [Asignar a vehÃ­culo...]                            â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <h4>IntegraciÃ³n con mÃ³dulo REPARTOS</h4>
            <p><strong>SincronizaciÃ³n bidireccional</strong>:</p>
            <ul>
                <li>âœ… Cambios en VENTAS â†’ Se reflejan en REPARTOS</li>
                <li>âœ… Cambios en REPARTOS â†’ Se reflejan en VENTAS</li>
                <li>âœ… Misma fuente de datos (tabla pedidos)</li>
            </ul>

            <p><strong>Flujo de trabajo tÃ­pico</strong>:</p>
            <pre><code>Usuario en mÃ³dulo VENTAS:
1. Filtra pedidos del dÃ­a (Lunes 23/12)
2. Ve que CamiÃ³n A tiene 5 pedidos
3. Click en "Ver repartos del dÃ­a"
4. Reasigna 2 pedidos de CamiÃ³n A â†’ CamiÃ³n B
5. Cierra modal
6. ContinÃºa con control financiero en VENTAS</code></pre>

            <p><strong>Ventaja</strong>: Operadores financieros no necesitan cambiar de mÃ³dulo para hacer ajustes simples de reparto.</p>

            <h3>3.8.9 Totales y estadÃ­sticas</h3>
            <p><strong>Panel superior del mÃ³dulo</strong>:</p>
            <p><strong>Con filtros aplicados, muestra</strong>:</p>
            <ul>
                <li>ğŸ“¦ Cantidad de pedidos (Ej: 45 pedidos)</li>
                <li>ğŸ’° Monto total vendido (Ej: $1.245.000)</li>
                <li>âš–ï¸ Kg totales despachados (Ej: 2.350 kg)</li>
            </ul>

            <p><strong>Discriminado por</strong>:</p>
            <ul>
                <li>ğŸ­ FÃ¡brica: X pedidos - $XXX</li>
                <li>ğŸšš Reparto: X pedidos - $XXX</li>
            </ul>

            <p><strong>Discriminado por mÃ©todo de pago</strong>:</p>
            <ul>
                <li>ğŸ’µ Efectivo: $XXX (X pedidos)</li>
                <li>ğŸ’³ Digital: $XXX (X pedidos)</li>
                <li>ğŸ’µğŸ’³ Mixto: $XXX (X pedidos)</li>
                <li>âš ï¸ Sin registrar: $XXX (X pedidos)</li>
            </ul>

            <h3>3.8.10 Exportar reportes</h3>
            <p><strong>BotÃ³n</strong>: "Exportar Excel"</p>

            <p><strong>Modal de selecciÃ³n de columnas</strong> â­ NUEVO (Dic 2025):</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Exportar a Excel - Seleccionar columnas   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  â˜‘ # Pedido                (obligatorio)   â”‚
â”‚  â˜‘ Fecha entrega           (obligatorio)   â”‚
â”‚  â˜‘ Cliente                                 â”‚
â”‚  â˜‘ DirecciÃ³n                               â”‚
â”‚  â˜‘ TelÃ©fono                â­ NUEVO        â”‚
â”‚  â˜‘ Tipo (FÃ¡brica/Reparto)                  â”‚
â”‚  â˜‘ VehÃ­culo                                â”‚
â”‚  â˜‘ Repartidor                              â”‚
â”‚  â˜‘ Productos (detalle)                     â”‚
â”‚  â˜‘ Subtotal                                â”‚
â”‚  â˜‘ Descuentos                              â”‚
â”‚  â˜‘ Ajustes                                 â”‚
â”‚  â˜‘ Total                                   â”‚
â”‚  â˜‘ MÃ©todo de pago                          â”‚
â”‚  â˜‘ Estado                                  â”‚
â”‚                                             â”‚
â”‚  [â˜‘ Seleccionar todo]  [â˜ Limpiar todo]    â”‚
â”‚                                             â”‚
â”‚  [Cancelar]  [Exportar]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>Comportamiento</strong>:</p>
            <ul>
                <li>âœ… <strong>Por defecto</strong>: Todas las columnas seleccionadas</li>
                <li>âœ… <strong>Columnas obligatorias</strong>: # Pedido y Fecha entrega (no se pueden desmarcar)</li>
                <li>âœ… <strong>Recordar selecciÃ³n</strong>: El sistema guarda la Ãºltima selecciÃ³n del usuario</li>
                <li>âœ… <strong>BotÃ³n "Seleccionar todo"</strong>: Marca todas las columnas</li>
                <li>âœ… <strong>BotÃ³n "Limpiar todo"</strong>: Desmarca todas excepto obligatorias</li>
            </ul>

            <p><strong>Columnas disponibles</strong> (segÃºn filtros activos):</p>
            <ul>
                <li># Pedido <em>(obligatorio)</em></li>
                <li>Fecha entrega <em>(obligatorio)</em></li>
                <li>Cliente</li>
                <li>DirecciÃ³n</li>
                <li><strong>TelÃ©fono</strong> â­ NUEVO</li>
                <li>Tipo (FÃ¡brica/Reparto)</li>
                <li>VehÃ­culo</li>
                <li>Repartidor</li>
                <li>Productos (detalle completo)</li>
                <li>Subtotal</li>
                <li>Descuentos</li>
                <li>Ajustes</li>
                <li><strong>Total</strong></li>
                <li><strong>MÃ©todo de pago</strong></li>
                <li>Estado</li>
            </ul>

            <p><strong>Formato</strong>: Excel con formato profesional, lista para enviar al contador</p>

            <p><strong>Ejemplo de uso</strong>:</p>
            <pre><code>Usuario solo necesita: Cliente, DirecciÃ³n, TelÃ©fono, Total, MÃ©todo de pago
â†’ Desmarca todas excepto esas columnas
â†’ Exporta Excel mÃ¡s compacto y fÃ¡cil de leer</code></pre>

            <h3>3.8.11 Calendario de Repartos: Vista Integrada en Ventas â­ IMPORTANTE</h3>

            <div class="note" style="border-left: 4px solid #dc3545; background: #f8d7da; padding: 1rem; margin: 1.5rem 0;">
                <h4>âš ï¸ ACLARACIÃ“N CRÃTICA: NO existe mÃ³dulo "Repartos" separado en v2</h4>
                <p><strong>El "Calendario de Repartos" es una VISTA/FILTRO dentro del mÃ³dulo VENTAS.</strong></p>
                <p>Esta aclaraciÃ³n corrige un error conceptual grave en documentaciÃ³n previa que lo mostraba como mÃ³dulo independiente.</p>
            </div>

            <h4>Concepto correcto:</h4>
            <blockquote>
                El mÃ³dulo VENTAS es el Ãºnico mÃ³dulo que contiene TODOS los pedidos post-cotizaciÃ³n.<br><br>
                El "Calendario de Repartos" es simplemente una <strong>vista filtrada</strong> que muestra pedidos tipo REPARTO que aÃºn NO estÃ¡n entregados, organizados por fecha en formato calendario semanal.
            </blockquote>

            <h4>Â¿DÃ³nde estÃ¡ el calendario?</h4>
            <ul>
                <li><strong>UbicaciÃ³n</strong>: MÃ³dulo VENTAS â†’ Tab "Calendario Semana"</li>
                <li><strong>FunciÃ³n</strong>: Vista de calendario (lunes-viernes) con pedidos tipo REPARTO</li>
                <li><strong>Filtro automÃ¡tico</strong>: Solo muestra pedidos donde <code>tipo = "REPARTO"</code> AND <code>estado != "Entregado"</code></li>
            </ul>

            <h4>Funcionalidad del calendario:</h4>
            <ul>
                <li>âœ… Vista semanal (lunes a viernes) con capacidad por dÃ­a</li>
                <li>âœ… Click en dÃ­a â†’ Abre vista detallada con pedidos del dÃ­a</li>
                <li>âœ… AsignaciÃ³n de pedidos a vehÃ­culos (drag & drop o modal)</li>
                <li>âœ… Reordenamiento de pedidos dentro de cada vehÃ­culo (ruta)</li>
                <li>âœ… ExportaciÃ³n dual: CON precios (control) / SIN precios (chofer)</li>
                <li>âœ… Pedidos sin asignar ordenados alfabÃ©ticamente por ciudad</li>
            </ul>

            <h4>Flujo correcto de un pedido REPARTO:</h4>
            <pre><code>1. COTIZADOR (modo REPARTO):
   Usuario crea pedido â†’ Selecciona fecha â†’ Confirma
        â†“
   Estado: "EN TRÃNSITO"
   Tipo: "REPARTO"
   Fecha asignada: XX/XX/XXXX
        â†“
2. MÃ“DULO VENTAS:
   Pedido aparece en TODAS las vistas:
     - Tab "Lista Pedidos" â†’ Filtro "En trÃ¡nsito" âœ… (aparece aquÃ­)
     - Tab "Calendario Semana" â†’ DÃ­a XX/XX âœ… (aparece aquÃ­)
     - Tab "Borradores" â†’ âŒ (no aparece, no es borrador)
        â†“
3. MÃ“DULO VENTAS â†’ Tab "Calendario Semana":
   Usuario organiza repartos del dÃ­a XX/XX:
     - Click en dÃ­a â†’ Abre vista detallada
     - Asigna pedido a vehÃ­culo (ej: Reparto 1)
     - Reordena segÃºn ruta de entrega
     - Exporta orden de reparto para chofer
        â†“
4. CHOFER entrega pedido:
   Repartidor completa entrega fÃ­sica
        â†“
5. MÃ“DULO VENTAS â†’ Tab "Lista Pedidos":
   Usuario busca el pedido â†’ Click "Marcar como Entregado"
   Registra mÃ©todo de pago (efectivo/digital/mixto)
   Confirma
        â†“
   Estado: "ENTREGADO"
        â†“
6. RESULTADO:
   El pedido SIGUE en mÃ³dulo VENTAS:
     - Tab "Lista Pedidos" â†’ Filtro "Entregado" âœ… (aparece aquÃ­)
     - Tab "Calendario Semana" â†’ âŒ (YA NO aparece, filtrado automÃ¡ticamente)

   âš ï¸ El pedido NO "desaparece de Repartos y aparece en Ventas"
   âš ï¸ El pedido SIEMPRE estuvo en VENTAS desde el paso 2
   âš ï¸ Solo cambia su visibilidad en la vista de calendario (filtrado)</code></pre>

            <h4>Regla de oro:</h4>
            <blockquote>
                <strong>TODOS los pedidos estÃ¡n en VENTAS desde que salen del Cotizador.</strong><br><br>
                El "Calendario" NO es un mÃ³dulo, es una VISTA FILTRADA que solo muestra pedidos REPARTO pendientes de entrega.<br><br>
                Cuando un pedido se marca como "Entregado", no "pasa a Ventas" porque YA ESTÃ en Ventas. Simplemente cambia de estado y el filtro del calendario lo oculta.
            </blockquote>

            <h4>IntegraciÃ³n con vehÃ­culos:</h4>
            <ul>
                <li><strong>AsignaciÃ³n</strong>: Desde vista de calendario en VENTAS</li>
                <li><strong>VehÃ­culos disponibles</strong>: Configurados en mÃ³dulo CONFIGURACIÃ“N</li>
                <li><strong>Nomenclatura simple</strong>: "Reparto 1", "Reparto 2", "Reparto 3"</li>
                <li><strong>Capacidad</strong>: Control de kg actual vs kg mÃ¡ximo por vehÃ­culo</li>
                <li><strong>ExportaciÃ³n</strong>: Excel para chofer (sin precios) o control (con precios)</li>
            </ul>

            <h4>Â¿Por quÃ© esta confusiÃ³n?</h4>
            <p>En versiones anteriores de la documentaciÃ³n (PRD inicial) se creÃ³ errÃ³neamente un archivo <code>prd/repartos.html</code> como si fuera un mÃ³dulo separado. <strong>Este concepto era INCORRECTO</strong> y ha sido eliminado.</p>

            <p><strong>La realidad del sistema es</strong>:</p>
            <ul>
                <li>âœ… Existe <strong>1 solo mÃ³dulo</strong>: VENTAS</li>
                <li>âœ… VENTAS tiene <strong>3 tabs/vistas</strong>:
                    <ul>
                        <li>Calendario Semana (vista de repartos)</li>
                        <li>Lista Pedidos (vista tabla completa)</li>
                        <li>Borradores (vista borradores guardados)</li>
                    </ul>
                </li>
                <li>âœ… Los pedidos NO se "mueven entre mÃ³dulos", solo cambian de estado y se filtran en vistas</li>
            </ul>

            <div class="note" style="border-left: 4px solid #28a745; background: #d4edda; padding: 1rem; margin: 1.5rem 0;">
                <h4>âœ… DOCUMENTO CORREGIDO (31 Diciembre 2025)</h4>
                <p><strong>CorrecciÃ³n aplicada</strong>: Eliminada documentaciÃ³n errÃ³nea de "Repartos" como mÃ³dulo separado.</p>
                <p><strong>Concepto correcto documentado</strong>: Calendario de repartos es vista filtrada dentro de VENTAS.</p>
                <p><strong>Flujos actualizados</strong>: Todos los flujos ahora reflejan correctamente que pedidos estÃ¡n siempre en VENTAS.</p>
            </div>

            <div class="note" style="border-left: 4px solid #28a745; background: #d4edda;">
                <h3>âœ… DOCUMENTO ACTUALIZADO - VERSIÃ“N MEJORADA</h3>
                <p><strong>Mejoras incorporadas (27/12/2025):</strong></p>
                <ul>
                    <li>âœ… <strong>Sistema hÃ­brido de pagos</strong>: Pagos asociados a pedidos vs Pagos genÃ©ricos (secciÃ³n 3.8.7.2)</li>
                    <li>âœ… <strong>Pagos parciales confirmados</strong>: Permitidos en AMBOS modos (REPARTO y FÃBRICA) - secciÃ³n 3.8.7.1</li>
                    <li>âœ… <strong>Pedidos sin cliente</strong>: Cliente especial "Sin registro" para ventas casuales (secciÃ³n 3.8.7.3)</li>
                    <li>âœ… <strong>Ejemplos completos</strong>: Casos de uso con pagos genÃ©ricos vs especÃ­ficos (3 escenarios detallados)</li>
                    <li>âœ… <strong>Regla de oro documentada</strong>: Columna "Pagado" solo muestra pagos asociados al pedido</li>
                    <li>âœ… <strong>Tabla comparativa v1 vs v2</strong>: Diferencias claras entre sistema actual y propuesto (8 aspectos)</li>
                    <li>âœ… <strong>Flujos detallados completos</strong>: 10 pasos especÃ­ficos para modo REPARTO con interacciÃ³n VENTAS â†” REPARTOS</li>
                    <li>âœ… <strong>InteracciÃ³n entre mÃ³dulos</strong>: Diagrama y tabla de responsabilidades COTIZADOR â†” VENTAS â†” REPARTOS</li>
                    <li>âœ… <strong>Historial de cambios OBLIGATORIO</strong>: Campos detallados para auditorÃ­a fiscal</li>
                </ul>
                <p><strong>Estado del documento</strong>: EspecificaciÃ³n funcional tÃ©cnica COMPLETA con sistema de pagos hÃ­brido definido.</p>
            </div>

            <div class="note" style="border-left: 4px solid #28a745; background: #d4edda;">
                <h3>âœ… PROTOTIPO HTML COMPLETADO (Diciembre 2025)</h3>
                <p><strong>UbicaciÃ³n</strong>: <code>sistema-version-2/prototipo-html-simple/ventas-v2.html</code></p>
                <p><strong>Estado</strong>: âœ… Prototipo funcional implementado con feedback del cliente</p>

                <h4>Cambios implementados en el prototipo:</h4>
                <ul>
                    <li>âœ… <strong>Header rediseÃ±ado</strong>: Filtros integrados sin labels (placeholders en selects)</li>
                    <li>âœ… <strong>Tabs reordenados</strong>: Calendario Semana (activo) â†’ Lista Pedidos â†’ Borradores</li>
                    <li>âœ… <strong>Stats panel compacto</strong>: Una lÃ­nea inline (reducciÃ³n ~60% espacio vertical)</li>
                    <li>âœ… <strong>Vista por defecto</strong>: Calendario Semana (antes: Pedidos)</li>
                    <li>âœ… <strong>Tarjetas calendario simplificadas</strong>:
                        <ul>
                            <li>Solo capacidad diaria: "15 de 40 pedidos", "320 de 6500 kg"</li>
                            <li>Eliminado: Estados (entregados/trÃ¡nsito), Pagos (efectivo/digital)</li>
                            <li>JustificaciÃ³n: Datos irreales antes de entrega real</li>
                        </ul>
                    </li>
                    <li>âœ… <strong>Tarjeta FÃ¡brica clickeable</strong>:
                        <ul>
                            <li>Al hacer clic â†’ Cambia a "Lista Pedidos"</li>
                            <li>Aplica filtros: Tipo=FÃ¡brica, PerÃ­odo=Semana actual</li>
                            <li>FunciÃ³n JS: <code>verVentasFabrica()</code></li>
                        </ul>
                    </li>
                    <li>âœ… <strong>Sidebar auto-collapse</strong>: Todos los mÃ³dulos (ver Cotizador)</li>
                </ul>

                <p><strong>DocumentaciÃ³n tÃ©cnica</strong>: Ver <code>_docs/VENTAS-ESPECIFICACION.md</code></p>
            </div>
        </section>

        <section id="prototipo-ui">
            <h2>7. ImplementaciÃ³n del Prototipo HTML (Dic 2025)</h2>

            <h3>7.1 Header con filtros integrados</h3>
            <p><strong>DecisiÃ³n de diseÃ±o</strong>: Eliminar barra de filtros separada e integrarlos en el header.</p>

            <p><strong>Antes</strong>:</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header: [ğŸ’° Ventas]      [Exportar Excel]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Filtros (barra separada):                   â”‚
â”‚ Estado: [Todos â–¼]                            â”‚
â”‚ PerÃ­odo: [01/12] â†’ [31/12]                   â”‚
â”‚ Tipo: [Todos â–¼]                              â”‚
â”‚ ...                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>Ahora</strong>:</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’° Ventas  [Estado: Todos â–¼] [PerÃ­odo â–¼] [Tipo â–¼]    â”‚
â”‚            [VehÃ­culo â–¼] [Pago â–¼] [ğŸ”„] [ğŸ“Š Exportar]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>Ventajas</strong>:</p>
            <ul>
                <li>âœ… Ahorra ~60px de altura vertical</li>
                <li>âœ… Filtros siempre visibles (sticky header)</li>
                <li>âœ… Placeholders auto-documentados (no necesita labels)</li>
                <li>âœ… Estilo consistente con mÃ³dulo Clientes</li>
            </ul>

            <h3>7.2 Stats panel compacto</h3>
            <p><strong>DecisiÃ³n</strong>: Reducir altura del panel de estadÃ­sticas a una sola lÃ­nea.</p>

            <p><strong>Estructura anterior</strong> (2 lÃ­neas por stat):</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦         â”‚  ğŸ’µ         â”‚  âš–ï¸         â”‚
â”‚    87       â”‚  $2.45M     â”‚  661 kg     â”‚
â”‚  Pedidos    â”‚  Monto      â”‚  Peso       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Altura: ~80px</code></pre>

            <p><strong>Estructura nueva</strong> (inline):</p>
            <pre><code>ğŸ“¦ 87 PEDIDOS | ğŸ’µ $2.45M MONTO | âš–ï¸ 661 kg PESO | ğŸ­ FÃ¡brica: 23 | ğŸšš Reparto: 64
Altura: ~36px (reducciÃ³n 55%)</code></pre>

            <h3>7.3 Calendario simplificado - Capacidad diaria</h3>
            <p><strong>Problema identificado</strong> (Feedback cliente - Dic 2025):</p>
            <blockquote>
                "Es irreal tener datos de entregados/trÃ¡nsito/efectivo/digital ANTES de que pase el dÃ­a de reparto. Estos datos se tienen 1-2 dÃ­as despuÃ©s. El calendario debe mostrar CAPACIDAD del dÃ­a."
            </blockquote>

            <p><strong>SoluciÃ³n implementada</strong>:</p>

            <table>
                <tr>
                    <th>Dato</th>
                    <th>Antes</th>
                    <th>Ahora</th>
                    <th>JustificaciÃ³n</th>
                </tr>
                <tr>
                    <td>Pedidos</td>
                    <td>"12 pedidos"</td>
                    <td>"15 de 40 pedidos"</td>
                    <td>Muestra capacidad usada vs total del dÃ­a</td>
                </tr>
                <tr>
                    <td>Peso</td>
                    <td>"320 kg"</td>
                    <td>"320 de 6500 kg"</td>
                    <td>Control de capacidad de carga por vehÃ­culos</td>
                </tr>
                <tr>
                    <td>Monto</td>
                    <td>"$285,000"</td>
                    <td>"$285,000"</td>
                    <td>Se mantiene (dato vÃ¡lido)</td>
                </tr>
                <tr>
                    <td>Entregados</td>
                    <td>âœ… "8 entregados"</td>
                    <td>âŒ ELIMINADO</td>
                    <td>Dato irreal antes de que pase el dÃ­a</td>
                </tr>
                <tr>
                    <td>En trÃ¡nsito</td>
                    <td>ğŸšš "4 en trÃ¡nsito"</td>
                    <td>âŒ ELIMINADO</td>
                    <td>Dato irreal antes de que pase el dÃ­a</td>
                </tr>
                <tr>
                    <td>Efectivo</td>
                    <td>ğŸ’µ "$180k"</td>
                    <td>âŒ ELIMINADO</td>
                    <td>Dato irreal, se registra post-entrega</td>
                </tr>
                <tr>
                    <td>Digital</td>
                    <td>ğŸ’³ "$105k"</td>
                    <td>âŒ ELIMINADO</td>
                    <td>Dato irreal, se registra post-entrega</td>
                </tr>
                <tr>
                    <td>BotÃ³n</td>
                    <td>"Ver detalle"</td>
                    <td>âŒ ELIMINADO</td>
                    <td>AcciÃ³n redundante</td>
                </tr>
            </table>

            <p><strong>Capacidades configuradas</strong>:</p>
            <pre><code>const CAPACIDADES = {
    pedidosPorDia: 40,    // Capacidad segÃºn vehÃ­culos disponibles
    pesoMaximoPorDia: 6500 // kg - Capacidad de carga total
};</code></pre>

            <h3>7.4 Tarjeta FÃ¡brica clickeable</h3>
            <p><strong>Funcionalidad nueva</strong>: Al hacer clic en tarjeta FÃ¡brica, ir a Lista Pedidos filtrada.</p>

            <p><strong>Flujo</strong>:</p>
            <pre><code>Usuario ve calendario semanal
            â†“
Click en tarjeta FÃBRICA
            â†“
Sistema ejecuta: verVentasFabrica()
            â†“
1. Cambia a tab "Lista Pedidos"
2. Aplica filtro Tipo: FÃ¡brica
3. Aplica filtro PerÃ­odo: Semana actual (23-27 Dic)
4. Ejecuta aplicarFiltros()
5. Scroll hacia arriba
            â†“
Usuario ve SOLO ventas de fÃ¡brica de esa semana</code></pre>

            <p><strong>CÃ³digo JS</strong>:</p>
            <pre><code>function verVentasFabrica() {
    switchView('pedidos');
    document.getElementById('filter-tipo').value = 'fabrica';
    document.getElementById('filter-fecha-desde').value = '2025-12-23';
    document.getElementById('filter-fecha-hasta').value = '2025-12-27';
    aplicarFiltros();
    document.getElementById('view-pedidos').scrollTop = 0;
}</code></pre>

            <h3>7.5 Tabs reordenados - Calendario primero</h3>
            <p><strong>DecisiÃ³n</strong> (Feedback cliente):</p>
            <blockquote>
                "Quiero que siempre arranque con vista calendario semanal, porque es la que mÃ¡s me importa para trabajar el dÃ­a a dÃ­a."
            </blockquote>

            <p><strong>Orden anterior</strong>:</p>
            <ol>
                <li>ğŸ“‹ Pedidos (activo por defecto)</li>
                <li>ğŸ“„ Borradores</li>
                <li>ğŸ“… Calendario Semana</li>
            </ol>

            <p><strong>Orden nuevo</strong>:</p>
            <ol>
                <li>ğŸ“… Calendario Semana (activo por defecto) â­</li>
                <li>ğŸ“‹ Lista Pedidos (rename de "Pedidos")</li>
                <li>ğŸ“„ Borradores</li>
            </ol>

            <p><strong>Cambio en naming</strong>: "Pedidos" â†’ "Lista Pedidos" (mÃ¡s descriptivo)</p>

            <h3>7.6 Calendario interactivo - SelecciÃ³n de dÃ­as y vehÃ­culos (NUEVO - Dic 29, 2025)</h3>
            <p><strong>Funcionalidad nueva</strong>: Sistema de selecciÃ³n de dÃ­as con vista de capacidades de vehÃ­culos.</p>

            <p><strong>Componentes principales</strong>:</p>
            <ol>
                <li><strong>Highlight dÃ­a actual</strong>: Background celeste suave para referencia rÃ¡pida</li>
                <li><strong>DÃ­a seleccionado</strong>: Borde azul al hacer clic</li>
                <li><strong>BotÃ³n "Ver detalle"</strong>: Dentro de cada tarjeta de dÃ­a</li>
                <li><strong>Capacidades de vehÃ­culos</strong>: Se muestran al seleccionar un dÃ­a</li>
            </ol>

            <p><strong>Flujo de interacciÃ³n</strong>:</p>
            <pre><code>Usuario ve calendario semanal
            â†“
Click en dÃ­a (ej: MiÃ©rcoles 25)
            â†“
Sistema ejecuta: seleccionarDia(element, 'miercoles')
            â†“
1. Remueve clase 'active' de todos los dÃ­as
2. Agrega clase 'active' al dÃ­a clickeado
3. Renderiza vehÃ­culos: renderVehiculosCapacidades('miercoles')
            â†“
Se muestra secciÃ³n de vehÃ­culos abajo del calendario
(Ver detalle en 7.7)
            â†“
Usuario ve capacidades actuales de R1, R2, R3</code></pre>

            <p><strong>DiseÃ±o visual - DÃ­a actual vs DÃ­a seleccionado</strong>:</p>
            <table>
                <tr>
                    <th>Estado</th>
                    <th>Estilo</th>
                    <th>PropÃ³sito</th>
                </tr>
                <tr>
                    <td><strong>DÃ­a actual (hoy)</strong></td>
                    <td>Background: <code>linear-gradient(#eff6ff, #ffffff)</code></td>
                    <td>Referencia rÃ¡pida del dÃ­a presente</td>
                </tr>
                <tr>
                    <td><strong>DÃ­a seleccionado</strong></td>
                    <td>Border: <code>2px solid #0052cc</code><br>Box-shadow azul</td>
                    <td>Indica selecciÃ³n activa del usuario</td>
                </tr>
            </table>

            <p><strong>BotÃ³n "Ver detalle"</strong>:</p>
            <ul>
                <li>UbicaciÃ³n: Dentro de cada tarjeta de dÃ­a</li>
                <li>FunciÃ³n: Abre vista especÃ­fica del dÃ­a (detalle completo con pedidos agrupables)</li>
                <li>Evento: <code>onclick="verDetalleDia(event, 'dia', 'numero')"</code></li>
                <li>Previene propagaciÃ³n: No activa selecciÃ³n del dÃ­a</li>
            </ul>

            <p><strong>CÃ³digo HTML - Tarjeta de dÃ­a</strong>:</p>
            <pre><code>&lt;div class="dia-card dia-hoy active"
     data-dia="miercoles"
     onclick="seleccionarDia(this, 'miercoles')"&gt;
    &lt;div class="dia-header"&gt;
        &lt;span class="dia-label"&gt;MIÃ‰RCOLES&lt;/span&gt;
        &lt;span class="dia-numero"&gt;25&lt;/span&gt;
        &lt;span class="dia-tipo"&gt;Reparto&lt;/span&gt;
    &lt;/div&gt;
    &lt;div class="dia-stats"&gt;
        &lt;div class="dia-stat"&gt;
            &lt;i class="fas fa-box"&gt;&lt;/i&gt;
            &lt;span&gt;18/40 ped&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class="dia-stat"&gt;
            &lt;i class="fas fa-weight"&gt;&lt;/i&gt;
            &lt;span&gt;485/6500 kg&lt;/span&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;button class="btn-ver-detalle-dia"
            onclick="verDetalleDia(event, 'miercoles', '25')"&gt;
        &lt;i class="fas fa-eye"&gt;&lt;/i&gt; Ver detalle
    &lt;/button&gt;
&lt;/div&gt;</code></pre>

            <h3>7.7 Capacidades de vehÃ­culos por dÃ­a (NUEVO - Dic 29, 2025)</h3>
            <p><strong>DescripciÃ³n</strong>: Vista compacta de ocupaciÃ³n de vehÃ­culos segÃºn el dÃ­a seleccionado en el calendario.</p>

            <p><strong>Layout diseÃ±o</strong>:</p>
            <ul>
                <li><strong>DisposiciÃ³n</strong>: Grid 3 columnas (R1 | R2 | R3)</li>
                <li><strong>DiseÃ±o</strong>: Horizontal compacto (nombre + stats inline)</li>
                <li><strong>Altura</strong>: ~50px por tarjeta (antes: ~120px - reducciÃ³n 58%)</li>
                <li><strong>Colores</strong>: Borde lateral segÃºn ocupaciÃ³n</li>
            </ul>

            <p><strong>Estructura de tarjeta vehÃ­culo</strong>:</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸšš Reparto 1   12/40 ped  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 30%    â”‚
â”‚                285/6500 kg â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 4%     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†‘              â†‘            â†‘
Nombre      Capacidad     Barra visual</code></pre>

            <p><strong>Indicadores de color</strong>:</p>
            <table>
                <tr>
                    <th>OcupaciÃ³n</th>
                    <th>Color borde</th>
                    <th>Color barra</th>
                    <th>Clase CSS</th>
                </tr>
                <tr>
                    <td>&lt; 50%</td>
                    <td>Verde (#10b981)</td>
                    <td>Verde (#10b981)</td>
                    <td><code>.capacidad-baja</code></td>
                </tr>
                <tr>
                    <td>50% - 80%</td>
                    <td>Naranja (#f59e0b)</td>
                    <td>Naranja (#f59e0b)</td>
                    <td><code>.capacidad-media</code></td>
                </tr>
                <tr>
                    <td>&gt; 80%</td>
                    <td>Rojo (#ef4444)</td>
                    <td>Rojo (#ef4444)</td>
                    <td><code>.capacidad-alta</code></td>
                </tr>
            </table>

            <p><strong>Datos mostrados por vehÃ­culo</strong>:</p>
            <ul>
                <li><strong>Pedidos</strong>: "12/40 ped" (ocupados/capacidad mÃ¡xima)</li>
                <li><strong>Peso</strong>: "285/6500 kg" (cargado/capacidad mÃ¡xima)</li>
                <li><strong>Barras visuales</strong>: % ocupaciÃ³n con animaciÃ³n</li>
            </ul>

            <p><strong>Mock data - VehÃ­culos por dÃ­a</strong>:</p>
            <pre><code>const VEHICULOS_POR_DIA = {
    lunes: [
        { nombre: 'Reparto 1', capacidad: 15, capacidadMax: 40,
          peso: 320, pesoMax: 6500 },
        { nombre: 'Reparto 2', capacidad: 0, capacidadMax: 40,
          peso: 0, pesoMax: 6500 },
        { nombre: 'Reparto 3', capacidad: 0, capacidadMax: 40,
          peso: 0, pesoMax: 6500 }
    ],
    miercoles: [
        { nombre: 'Reparto 1', capacidad: 12, capacidadMax: 40,
          peso: 285, pesoMax: 6500 },
        { nombre: 'Reparto 2', capacidad: 6, capacidadMax: 40,
          peso: 200, pesoMax: 6500 },
        { nombre: 'Reparto 3', capacidad: 0, capacidadMax: 40,
          peso: 0, pesoMax: 6500 }
    ]
    // ... otros dÃ­as
};</code></pre>

            <p><strong>CÃ³digo JS - Renderizar vehÃ­culos</strong>:</p>
            <pre><code>function renderVehiculosCapacidades(dia) {
    const container = document.getElementById('vehiculos-capacidades');
    const vehiculos = VEHICULOS_POR_DIA[dia] || [];

    container.innerHTML = vehiculos.map(vehiculo => {
        const porcentajePedidos = (vehiculo.capacidad / vehiculo.capacidadMax) * 100;
        const porcentajePeso = (vehiculo.peso / vehiculo.pesoMax) * 100;
        const porcentajePromedio = (porcentajePedidos + porcentajePeso) / 2;

        let colorClass = 'capacidad-baja';
        if (porcentajePromedio >= 80) colorClass = 'capacidad-alta';
        else if (porcentajePromedio >= 50) colorClass = 'capacidad-media';

        return `
            &lt;div class="vehiculo-card ${colorClass}"&gt;
                &lt;div class="vehiculo-nombre"&gt;
                    &lt;i class="fas fa-truck"&gt;&lt;/i&gt;
                    &lt;strong&gt;${vehiculo.nombre}&lt;/strong&gt;
                &lt;/div&gt;
                &lt;div class="vehiculo-stats"&gt;
                    &lt;div class="stat-row"&gt;
                        &lt;span class="stat-text"&gt;${vehiculo.capacidad}/${vehiculo.capacidadMax} ped&lt;/span&gt;
                        &lt;div class="capacidad-barra"&gt;
                            &lt;div class="capacidad-fill" style="width: ${porcentajePedidos}%"&gt;&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class="stat-row"&gt;
                        &lt;span class="stat-text"&gt;${vehiculo.peso}/${vehiculo.pesoMax} kg&lt;/span&gt;
                        &lt;div class="capacidad-barra"&gt;
                            &lt;div class="capacidad-fill" style="width: ${porcentajePeso}%"&gt;&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        `;
    }).join('');
}</code></pre>

            <p><strong>CSS - Estilos compactos</strong>:</p>
            <pre><code>.vehiculos-capacidades {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
}

.vehiculo-card {
    padding: 10px 14px;  /* Reducido de 16px */
    display: flex;
    align-items: center;
    gap: 14px;
}

.vehiculo-card.capacidad-baja {
    border-left: 3px solid #10b981;
}

.capacidad-barra {
    flex: 1;
    height: 5px;  /* Reducido de 8px */
    background: #e5e7eb;
    border-radius: 3px;
}</code></pre>

            <h3>7.8 Bug fix - Filtro FÃ¡brica (Dic 29, 2025)</h3>
            <p><strong>Problema identificado</strong>: Al hacer clic en tarjeta FÃ¡brica, el filtro no se aplicaba correctamente.</p>

            <p><strong>Causa raÃ­z</strong>:</p>
            <ul>
                <li>La funciÃ³n solo actualizaba el valor del <code>&lt;select&gt;</code> en el DOM</li>
                <li>NO actualizaba <code>appState.filtros.tipo</code></li>
                <li><code>aplicarFiltros()</code> lee desde <code>appState.filtros</code>, no del DOM</li>
            </ul>

            <p><strong>SoluciÃ³n aplicada</strong>:</p>
            <pre><code>// ANTES (no funcionaba)
function verVentasFabrica() {
    switchView('pedidos');
    document.getElementById('filter-tipo').value = 'fabrica';
    aplicarFiltros();  // âŒ Lee appState.filtros, no el DOM
}

// AHORA (funciona correctamente)
function verVentasFabrica() {
    switchView('pedidos');

    // Actualizar DOM
    document.getElementById('filter-tipo').value = 'fabrica';
    document.getElementById('filter-fecha-desde').value = '2025-12-23';
    document.getElementById('filter-fecha-hasta').value = '2025-12-27';

    // âœ… Actualizar appState.filtros (CRÃTICO)
    appState.filtros.tipo = 'fabrica';
    appState.filtros.fechaDesde = '2025-12-23';
    appState.filtros.fechaHasta = '2025-12-27';

    // âœ… Re-renderizar completo
    render();  // Usa aplicarFiltros() + renderizarTabla() + renderizarPaginacion()

    document.getElementById('view-pedidos').scrollTop = 0;
}</code></pre>

            <h3>7.9 Acciones rÃ¡pidas desde calendario (Dic 29, 2025)</h3>
            <p><strong>Cada dÃ­a del calendario incluye 2 botones de acciÃ³n en layout horizontal:</strong></p>

            <table>
                <tr>
                    <th>BotÃ³n</th>
                    <th>FunciÃ³n</th>
                    <th>DescripciÃ³n</th>
                </tr>
                <tr>
                    <td><strong>Ver detalle</strong></td>
                    <td>Abrir vista especÃ­fica del dÃ­a</td>
                    <td>Acceso directo a vista de agrupaciÃ³n de pedidos por vehÃ­culos con drag & drop</td>
                </tr>
                <tr>
                    <td><strong>Ver pedidos</strong></td>
                    <td>Filtrar Lista Pedidos por fecha</td>
                    <td>Abre tab "Lista Pedidos" con filtro de fecha especÃ­fica del dÃ­a seleccionado</td>
                </tr>
            </table>

            <p><strong>Layout botones:</strong></p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LUNES 23               â”‚
â”‚ 15/40 ped | 3320/6250  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Ver detalle][Ver ped] â”‚ â† Horizontal, 50% cada uno
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>Tarjeta FÃ¡brica:</strong></p>
            <ul>
                <li>BotÃ³n Ãºnico "Ver detalle" (ancho completo)</li>
                <li>Clic en tarjeta â†’ Filtra Lista Pedidos tipo=FÃ¡brica semana actual</li>
            </ul>

            <h3>7.10 Capacidades de vehÃ­culos - Especificaciones tÃ©cnicas</h3>

            <p><strong>Capacidades reales por vehÃ­culo:</strong></p>
            <table>
                <tr>
                    <th>VehÃ­culo</th>
                    <th>Capacidad MÃ¡xima (kg)</th>
                </tr>
                <tr>
                    <td>Reparto 1</td>
                    <td>2,250 kg</td>
                </tr>
                <tr>
                    <td>Reparto 2</td>
                    <td>1,500 kg</td>
                </tr>
                <tr>
                    <td>Reparto 3</td>
                    <td>2,500 kg</td>
                </tr>
                <tr>
                    <td><strong>TOTAL DÃA</strong></td>
                    <td><strong>6,250 kg</strong></td>
                </tr>
            </table>

            <p><strong>Datos mostrados en tarjetas de vehÃ­culos:</strong></p>
            <ul>
                <li><strong>Pedidos actuales</strong>: NÃºmero simple (sin "/40", capacidad total solo visible en dÃ­a)</li>
                <li><strong>Capacidad peso</strong>: "1680/2250 kg" (negrita, resaltado)</li>
                <li><strong>Barra de progreso</strong>: Solo para peso, altura 10px (no para pedidos)</li>
                <li><strong>Colores indicadores</strong>:
                    <ul>
                        <li>Verde (#10b981): &lt; 50% ocupaciÃ³n</li>
                        <li>Naranja (#f59e0b): 50-80% ocupaciÃ³n</li>
                        <li>Rojo (#ef4444): &gt; 80% ocupaciÃ³n</li>
                    </ul>
                </li>
            </ul>

            <p><strong>Layout tarjeta vehÃ­culo (horizontal):</strong></p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸšš Reparto 1    1680/2250 kg      â”‚
â”‚ 8 pedidos       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 75%       â”‚
â”‚                 â””â”€ Barra 10px      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†‘ Izquierda          â†‘ Derecha
  Nombre+Pedidos    Capacidad+Barra</code></pre>

            <p><strong>Coherencia de datos mock:</strong></p>
            <ul>
                <li>Pedidos del dÃ­a = Suma de pedidos de los 3 repartos</li>
                <li>Kg del dÃ­a = Suma de kg de los 3 repartos</li>
                <li>Ejemplo MiÃ©rcoles: 18 ped (8+6+4), 4485 kg (1680+1120+1685)</li>
            </ul>

            <h3>7.11 Estados de dÃ­as y control de reparto (Dic 29, 2025)</h3>
            <p><strong>Problema identificado</strong>: Los datos de efectivo/digital en las tarjetas de dÃ­as son irreales hasta que:</p>
            <ol>
                <li>Pase el dÃ­a de reparto</li>
                <li>Vuelva el repartidor con la hoja</li>
                <li>Se haga el control manual del dÃ­a (cambiar pedidos En trÃ¡nsito â†’ Entregado)</li>
                <li>Se registren los pagos reales en Cuenta Corriente</li>
            </ol>

            <p><strong>SoluciÃ³n implementada</strong>: Sistema de estados de dÃ­as con badges y datos progresivos.</p>

            <h4>Estados de un dÃ­a:</h4>
            <table>
                <tr>
                    <th>Estado</th>
                    <th>CondiciÃ³n</th>
                    <th>Badge</th>
                    <th>Datos de pago</th>
                </tr>
                <tr>
                    <td><strong>Futuro</strong></td>
                    <td>Fecha > Hoy</td>
                    <td>"Planificado" (azul #3b82f6)</td>
                    <td>âŒ No (aÃºn no pasÃ³)</td>
                </tr>
                <tr>
                    <td><strong>Hoy</strong></td>
                    <td>Fecha = Hoy</td>
                    <td>"HOY" (azul #3b82f6)</td>
                    <td>âŒ No (dÃ­a en curso)</td>
                </tr>
                <tr>
                    <td><strong>Sin control</strong></td>
                    <td>Fecha < Hoy, no controlado</td>
                    <td>BotÃ³n "Controlar" (naranja #f59e0b)</td>
                    <td>ğŸ’µ XXX ğŸ’³ XXX (ocultos)</td>
                </tr>
                <tr>
                    <td><strong>Controlado</strong></td>
                    <td>Fecha < Hoy, controlado manualmente</td>
                    <td>"Controlado" (verde #10b981)</td>
                    <td>âœ… SÃ­ (ğŸ’µ $120k ğŸ’³ $75k)</td>
                </tr>
            </table>

            <h4>DiseÃ±o visual - Tarjetas segÃºn estado:</h4>

            <p><strong>1. DÃ­a FUTURO (Planificado)</strong>:</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VIERNES          [Planificado] â”‚ â† Badge azul
â”‚ 27                             â”‚
â”‚ Reparto                        â”‚
â”‚                                â”‚
â”‚ ğŸ“¦ 10/40 ped                   â”‚
â”‚ âš–ï¸  2220/6250 kg               â”‚
â”‚                                â”‚ â† SIN datos de pago
â”‚ [Ver detalle] [Ver pedidos]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>2. DÃ­a HOY (Actual)</strong>:</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MIÃ‰RCOLES              [HOY]   â”‚ â† Badge azul
â”‚ 25                             â”‚
â”‚ Reparto                        â”‚
â”‚                                â”‚
â”‚ ğŸ“¦ 18/40 ped                   â”‚
â”‚ âš–ï¸  4485/6250 kg               â”‚
â”‚                                â”‚ â† SIN datos de pago
â”‚ [Ver detalle] [Ver pedidos]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Background: linear-gradient(#eff6ff, #fff) â† Destaque visual</code></pre>

            <p><strong>3. DÃ­a SIN CONTROL (Pasado no controlado)</strong>:</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LUNES             [Controlar]  â”‚ â† BotÃ³n naranja clickeable
â”‚ 23                             â”‚
â”‚ Reparto                        â”‚
â”‚                                â”‚
â”‚ ğŸ“¦ 15/40 ped                   â”‚
â”‚ âš–ï¸  3320/6250 kg               â”‚
â”‚ ğŸ’µ XXX  ğŸ’³ XXX                 â”‚ â† Datos ocultos con XXX
â”‚                                â”‚
â”‚ [Ver detalle] [Ver pedidos]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>Comportamiento botÃ³n "Controlar"</strong>:</p>
            <ul>
                <li>Click â†’ NO marca el dÃ­a como controlado directamente</li>
                <li>AcciÃ³n: Filtra la Lista Pedidos por fecha del dÃ­a</li>
                <li>Usuario revisa todos los pedidos del dÃ­a en la lista</li>
                <li>Usuario marca pedidos como entregados, registra pagos en CC</li>
                <li>Cuando termina: Click en botÃ³n "MARCAR COMO CONTROLADO" desde la lista</li>
            </ul>

            <p><strong>4. DÃ­a CONTROLADO (Pasado controlado)</strong>:</p>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MARTES          [Controlado]   â”‚ â† Badge verde
â”‚ 24                             â”‚
â”‚ Reparto                        â”‚
â”‚                                â”‚
â”‚ ğŸ“¦ 12/40 ped                   â”‚
â”‚ âš–ï¸  2280/6250 kg               â”‚
â”‚ ğŸ’µ $120k  ğŸ’³ $75k              â”‚ â† NÃºmeros reales
â”‚                                â”‚
â”‚ [Ver detalle] [Ver pedidos]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>CÃ¡lculo de montos efectivo/digital</strong>:</p>
            <pre><code>// Sumar todos los pedidos ENTREGADOS del dÃ­a
const pedidosDelDia = pedidos.filter(p =>
  p.fecha === '2025-12-24' && p.estado === 'entregado'
);

// Efectivo (incluye pagos mixtos)
const efectivo = pedidosDelDia
  .filter(p => p.metodoPago === 'efectivo' || p.metodoPago === 'mixto')
  .reduce((sum, p) => sum + (p.montoEfectivo || 0), 0);

// Digital (incluye pagos mixtos)
const digital = pedidosDelDia
  .filter(p => p.metodoPago === 'digital' || p.metodoPago === 'mixto')
  .reduce((sum, p) => sum + (p.montoDigital || 0), 0);</code></pre>

            <h4>Badge en Lista Pedidos - DÃ­a filtrado:</h4>
            <p><strong>Cuando se filtra la lista por un dÃ­a especÃ­fico</strong>, aparece un badge junto al contador de resultados:</p>

            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <strong>87 resultados</strong>  [HOY]                    â”‚ â† DÃ­a actual
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ # â”‚ Fecha â”‚ Cliente â”‚ ...                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <strong>45 resultados</strong>  [Planificado]            â”‚ â† DÃ­a futuro
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <strong>23 resultados</strong>  [MARCAR COMO CONTROLADO] â”‚ â† DÃ­a sin control
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <strong>12 resultados</strong>  [Controlado]              â”‚ â† DÃ­a controlado
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</code></pre>

            <h4>Flujo completo - Controlar un dÃ­a:</h4>
            <pre><code>1. Usuario ve calendario semanal
   â†“
2. DÃ­a pasÃ³ (ej: Lunes 23) â†’ Muestra badge [Controlar]
   â†“
3. Click en badge "Controlar"
   â†“
4. Sistema:
   - Cambia a tab "Lista Pedidos"
   - Filtra por fecha: 2025-12-23
   - Muestra badge "MARCAR COMO CONTROLADO"
   â†“
5. Usuario revisa todos los pedidos del dÃ­a:
   - Marca pedidos En trÃ¡nsito â†’ Entregado
   - Registra pagos en Cuenta Corriente
   - Ajusta cantidades/precios si es necesario
   â†“
6. Click en botÃ³n "MARCAR COMO CONTROLADO"
   â†“
7. Modal de confirmaciÃ³n:
   âš ï¸ Si hay pedidos en trÃ¡nsito:
   "Hay 5 pedidos aÃºn EN TRÃNSITO:
    - Pedido #1240: Av. Mitre 123
    - Pedido #1241: Calle 45
    ...
    Â¿Marcar dÃ­a como controlado de todas formas?"

   âœ… Si todos estÃ¡n entregados:
   "Todos los pedidos estÃ¡n ENTREGADOS.
    Â¿Confirmas que ya revisaste todos los pedidos?"
   â†“
8. Usuario confirma
   â†“
9. Sistema:
   - Marca dÃ­a: controlado = true
   - Registra timestamp: fechaControl
   - Actualiza badge: "Controlar" â†’ "Controlado"
   - Muestra datos reales: ğŸ’µ $180k ğŸ’³ $75k
   â†“
10. DÃ­a queda CONTROLADO (datos confirmados)</code></pre>

            <h4>Tarjeta FÃ¡brica - Badge especial:</h4>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FÃ¡brica           [SEMANAL]    â”‚ â† Badge gris
â”‚ Semana completa                â”‚
â”‚                                â”‚
â”‚ ğŸ“¦ 45 ped                      â”‚
â”‚ âš–ï¸  520 kg                     â”‚
â”‚ ğŸ’µ $XXX  ğŸ’³ $XXX               â”‚ â† Siempre XXX (no por dÃ­a)
â”‚                                â”‚
â”‚ [Ver pedidos]                  â”‚ â† Un solo botÃ³n
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <p><strong>Comportamiento FÃ¡brica</strong>:</p>
            <ul>
                <li>Badge: "SEMANAL" (color gris #6b7280)</li>
                <li>Efectivo/Digital: Siempre XXX (no tiene concepto de "dÃ­a controlado")</li>
                <li>Click en tarjeta: Filtra Lista por tipo=FÃ¡brica, semana actual</li>
                <li>Un solo botÃ³n: "Ver pedidos"</li>
            </ul>

            <h4>Estructura de datos - Modelo dÃ­a:</h4>
            <pre><code>const DIAS_CALENDARIO = {
  '2025-12-23': {
    fecha: '2025-12-23',
    dia: 'lunes',
    numero: 23,
    tipo: 'reparto',
    pedidosCount: 15,
    pesoTotal: 3320,
    montoTotal: 285000,
    // CONTROL DE DÃA
    controlado: false,          // true cuando se marca como controlado
    fechaControl: null,         // timestamp cuando se controlÃ³
    notasControl: '',           // notas opcionales del control
    // Pagos calculados (null si no controlado)
    efectivoFinal: null,        // monto efectivo confirmado
    digitalFinal: null          // monto digital confirmado
  }
};</code></pre>

            <h4>FunciÃ³n cÃ¡lculo de estado:</h4>
            <pre><code>function calcularEstadoDia(fecha) {
  const hoy = FECHA_HOY_MOCK; // '2025-12-25' en prototipo
  const fechaDia = fecha;     // '2025-12-23'

  if (fechaDia > hoy) {
    return 'futuro';          // Badge: Planificado
  } else if (fechaDia === hoy) {
    return 'hoy';             // Badge: HOY
  } else {
    // DÃ­a pasado: verificar si estÃ¡ controlado
    const diaData = DIAS_CALENDARIO[fecha];
    return diaData?.controlado ? 'controlado' : 'sin-control';
  }
}</code></pre>

            <h4>CSS - Estilos de badges:</h4>
            <pre><code>/* Badge Planificado (azul) */
.badge-estado-planificado {
  background: #3b82f6;
  color: white;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 10px;
  font-weight: 700;
}

/* Badge HOY (azul) */
.badge-estado-hoy {
  background: #3b82f6;
  /* ... mismo estilo */
}

/* BotÃ³n Controlar (naranja, clickeable) */
.badge-estado-controlar {
  background: #f59e0b;
  color: white;
  /* ... */
  cursor: pointer;
  transition: all 0.2s ease;
}

.badge-estado-controlar:hover {
  background: #d97706;
  transform: scale(1.05);
}

/* Badge Controlado (verde) */
.badge-estado-controlado {
  background: #10b981;
  /* ... */
}

/* Badge SEMANAL (gris) */
.badge-estado-semanal {
  background: #6b7280;
  /* ... */
}</code></pre>

            <h4>IntegraciÃ³n con flujo existente:</h4>
            <ol>
                <li><strong>Cotizador</strong> â†’ Crea pedido con fecha â†’ Va a Ventas (estado: En trÃ¡nsito)</li>
                <li><strong>DÃ­a pasa</strong> â†’ Badge cambia: "Planificado" â†’ "Controlar"</li>
                <li><strong>Usuario controla</strong>:
                    <ul>
                        <li>Click "Controlar" â†’ Lista Pedidos filtrada</li>
                        <li>Marca pedidos como entregados</li>
                        <li>Registra pagos en CC</li>
                        <li>Click "MARCAR COMO CONTROLADO"</li>
                    </ul>
                </li>
                <li><strong>DÃ­a controlado</strong> â†’ Badge: "Controlado", muestra ğŸ’µ $180k ğŸ’³ $75k</li>
            </ol>

            <div class="note" style="border-left: 4px solid #0052cc; background: #e3f2fd; padding: 1rem; margin: 1.5rem 0;">
                <h4>ğŸ“Š Exportar Excel - Columna "Estado DÃ­a"</h4>
                <p>El reporte Excel incluye una columna "Estado DÃ­a" con valores:</p>
                <ul>
                    <li><strong>Futuro (Planificado)</strong>: DÃ­as que aÃºn no pasaron</li>
                    <li><strong>Hoy (En curso)</strong>: DÃ­a actual</li>
                    <li><strong>Sin control</strong>: DÃ­as pasados sin revisar</li>
                    <li><strong>Controlado</strong>: DÃ­as revisados y confirmados (+ fecha control)</li>
                </ul>
                <p>Ãštil para auditorÃ­a: saber quÃ© dÃ­as tienen datos confirmados vs estimados.</p>
            </div>

            <div class="note" style="border-left: 4px solid #28a745; background: #d4edda; padding: 1rem; margin: 1.5rem 0;">
                <h4>âœ… PROTOTIPO COMPLETO (29 Diciembre 2025)</h4>
                <p><strong>Estado</strong>: MÃ³dulo Ventas - Calendario Semana funcional al 100%</p>
                <p><strong>Funcionalidades implementadas:</strong></p>
                <ul>
                    <li>Calendario interactivo con selecciÃ³n de dÃ­as</li>
                    <li>DÃ­a actual destacado (background celeste)</li>
                    <li>Capacidades de vehÃ­culos por dÃ­a (layout horizontal compacto)</li>
                    <li>Botones de acciÃ³n: Ver detalle + Ver pedidos</li>
                    <li>Indicadores visuales de ocupaciÃ³n (verde/naranja/rojo)</li>
                    <li>Stats en negrita para mejor legibilidad</li>
                    <li>Filtros funcionales con appState sincronizado</li>
                    <li><strong>Sistema de estados de dÃ­as:</strong> Futuro/Hoy/Sin control/Controlado â­</li>
                    <li><strong>Badges dinÃ¡micos:</strong> Planificado, HOY, Controlar, Controlado, SEMANAL â­</li>
                    <li><strong>Datos progresivos:</strong> XXX (sin control) â†’ NÃºmeros reales (controlado) â­</li>
                    <li><strong>Control manual con validaciÃ³n:</strong> Modal con advertencia de pedidos en trÃ¡nsito â­</li>
                </ul>
                <p><strong>PrÃ³xima sesiÃ³n</strong>: Nuevas features a agregar segÃºn feedback usuario</p>

            <h3>7.12 Datos Mock actualizados - 60 pedidos con productos</h3>
            <p><strong>Estructura de datos</strong>: Sistema de generaciÃ³n dinÃ¡mica de pedidos y productos mock para demostraciÃ³n completa del flujo.</p>

            <p><strong>Pedidos Mock</strong>:</p>
            <ul>
                <li><strong>Total</strong>: 60 pedidos variados</li>
                <li><strong>PaginaciÃ³n</strong>: 12 pedidos por pÃ¡gina â†’ 5 pÃ¡ginas</li>
                <li><strong>DistribuciÃ³n temporal</strong>:
                    <ul>
                        <li>Lunes 23: 11 pedidos (10 reparto + 1 fÃ¡brica) - 7 entregados, 4 en trÃ¡nsito</li>
                        <li>Martes 24: 11 pedidos (10 reparto + 1 fÃ¡brica) - 5 entregados, 6 en trÃ¡nsito</li>
                        <li>MiÃ©rcoles 25: 14 pedidos (12 reparto + 2 fÃ¡brica) - 4 entregados, 10 en trÃ¡nsito</li>
                        <li>Jueves 26: 12 pedidos (10 reparto + 2 fÃ¡brica) - todos en trÃ¡nsito</li>
                        <li>Viernes 27: 12 pedidos (9 reparto + 3 fÃ¡brica) - todos en trÃ¡nsito</li>
                    </ul>
                </li>
                <li><strong>Variedad realista</strong>: Diferentes vehÃ­culos (R1/R2/R3), mÃ©todos de pago (efectivo/digital/mixto), ciudades</li>
            </ul>

            <p><strong>Productos Mock</strong>:</p>
            <ul>
                <li><strong>CatÃ¡logo</strong>: 15 productos quÃ­micos (detergentes, lavandinas, desinfectantes, etc.)</li>
                <li><strong>Por pedido</strong>: 2-5 productos con cantidades variables (1-8 unidades)</li>
                <li><strong>GeneraciÃ³n automÃ¡tica</strong>: FunciÃ³n <code>generateProductosMock()</code></li>
            </ul>

            <h3>7.13 Acciones masivas (Bulk Actions)</h3>
            <p><strong>Funcionalidad</strong>: SelecciÃ³n mÃºltiple con acciones en batch.</p>

            <p><strong>Componentes</strong>:</p>
            <ol>
                <li><strong>Check all</strong>: Checkbox en header selecciona todos</li>
                <li><strong>Barra verde</strong>: Gradiente <code>#3d883d â†’ #52943a</code>, padding 8px 16px</li>
                <li><strong>Marcar como Entregado</strong>: Solo pedidos "EN TRÃNSITO", con confirmaciÃ³n</li>
            </ol>

            <h3>7.14 Enlaces de navegaciÃ³n</h3>
            <p><strong>Conexiones implementadas</strong>:</p>
            <ul>
                <li>Cliente/DirecciÃ³n â†’ <code>cliente-detalle-v2.html</code></li>
                <li>Modal Detalle â†’ Modal Editar (botÃ³n "Editar Pedido")</li>
                <li>DÃ­as semana â†’ Lista filtrada (fecha + tipo "reparto")</li>
                <li>Tarjeta FÃ¡brica â†’ Lista filtrada (tipo "fÃ¡brica")</li>
            </ul>

            <h3>7.15 Interfaz compacta</h3>
            <p><strong>Reducciones de padding</strong>: Header -37%, Stats -16%, Bulk -42%, Tabla -37%</p>
            <p><strong>Resultado</strong>: ~30% mÃ¡s contenido visible</p>

            <h3>7.16 Estado simplificado</h3>
            <p><strong>Cambio</strong>: Columna "Estado" solo muestra badge, sin fecha/hora de entrega</p>
            <p><strong>JustificaciÃ³n</strong>: "No sabemos hora exacta, operario marca al dÃ­a siguiente"</p>

            <div class="note" style="border-left: 4px solid #28a745; background: #d4edda; padding: 1rem; margin: 1.5rem 0;">
                <h4>âœ… PROTOTIPO ACTUALIZADO (30 Diciembre 2025)</h4>
                <p><strong>Estado</strong>: Funcional con 60 pedidos mock, bulk actions, navegaciÃ³n entre mÃ³dulos, interfaz compacta</p>
                <p><strong>Listo para</strong>: DemostraciÃ³n completa al cliente</p>
            </div>
            </div>
        </section>


    </main>

</body>

</html>